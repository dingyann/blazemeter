!function(e){var o={};function t(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var r in e)t.d(n,r,function(o){return e[o]}.bind(null,r));return n},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=39)}({1:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),"undefined"==typeof window?o.browser={}:o.browser=t(2)},2:function(e,o,t){var n,r,a;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,r=[e],void 0===(a="function"==typeof(n=function(e){"use strict";if("undefined"==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype){const o="The message port closed before a response was received.",t="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,o){super(o),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const a=(o,t)=>(...n)=>{e.runtime.lastError?o.reject(e.runtime.lastError):t.singleCallbackArg||n.length<=1&&!1!==t.singleCallbackArg?o.resolve(n[0]):o.resolve(n)},s=e=>1==e?"argument":"arguments",l=(e,o,t)=>new Proxy(o,{apply:(o,n,r)=>t.call(n,e,...r)});let i=Function.call.bind(Object.prototype.hasOwnProperty);const c=(e,o={},t={})=>{let n=Object.create(null),r={has:(o,t)=>t in e||t in n,get(r,d,u){if(d in n)return n[d];if(!(d in e))return;let p=e[d];if("function"==typeof p)if("function"==typeof o[d])p=l(e,e[d],o[d]);else if(i(t,d)){let o=((e,o)=>(function(t,...n){if(n.length<o.minArgs)throw new Error(`Expected at least ${o.minArgs} ${s(o.minArgs)} for ${e}(), got ${n.length}`);if(n.length>o.maxArgs)throw new Error(`Expected at most ${o.maxArgs} ${s(o.maxArgs)} for ${e}(), got ${n.length}`);return new Promise((r,s)=>{if(o.fallbackToNoCallback)try{t[e](...n,a({resolve:r,reject:s},o))}catch(a){console.warn(`${e} API method doesn't seem to support the callback parameter, `+"falling back to call it without a callback: ",a),t[e](...n),o.fallbackToNoCallback=!1,o.noCallback=!0,r()}else o.noCallback?(t[e](...n),r()):t[e](...n,a({resolve:r,reject:s},o))})}))(d,t[d]);p=l(e,e[d],o)}else p=p.bind(e);else if("object"==typeof p&&null!==p&&(i(o,d)||i(t,d)))p=c(p,o[d],t[d]);else{if(!i(t,"*"))return Object.defineProperty(n,d,{configurable:!0,enumerable:!0,get:()=>e[d],set(o){e[d]=o}}),p;p=c(p,o[d],t["*"])}return n[d]=p,p},set:(o,t,r,a)=>(t in n?n[t]=r:e[t]=r,!0),defineProperty:(e,o,t)=>Reflect.defineProperty(n,o,t),deleteProperty:(e,o)=>Reflect.deleteProperty(n,o)},d=Object.create(e);return new Proxy(d,r)},d=e=>({addListener(o,t,...n){o.addListener(e.get(t),...n)},hasListener:(o,t)=>o.hasListener(e.get(t)),removeListener(o,t){o.removeListener(e.get(t))}});let u=!1;const p=new r(e=>"function"!=typeof e?e:function(o,n,r){let a,s,l=!1,i=new Promise(e=>{a=function(o){u||(console.warn(t,(new Error).stack),u=!0),l=!0,e(o)}});try{s=e(o,n,a)}catch(e){s=Promise.reject(e)}const c=!0!==s&&(e=>e&&"object"==typeof e&&"function"==typeof e.then)(s);if(!0!==s&&!c&&!l)return!1;const d=e=>{e.then(e=>{r(e)},e=>{let o;o=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:o})}).catch(e=>{console.error("Failed to send onMessage rejected reply",e)})};return d(c?s:i),!0}),m=({reject:t,resolve:n},r)=>{e.runtime.lastError?e.runtime.lastError.message===o?n():t(e.runtime.lastError):r&&r.__mozWebExtensionPolyfillReject__?t(new Error(r.message)):n(r)},g=(e,o,t,...n)=>{if(n.length<o.minArgs)throw new Error(`Expected at least ${o.minArgs} ${s(o.minArgs)} for ${e}(), got ${n.length}`);if(n.length>o.maxArgs)throw new Error(`Expected at most ${o.maxArgs} ${s(o.maxArgs)} for ${e}(), got ${n.length}`);return new Promise((e,o)=>{const r=m.bind(null,{resolve:e,reject:o});n.push(r),t.sendMessage(...n)})},$={runtime:{onMessage:d(p),onMessageExternal:d(p),sendMessage:g.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:g.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},h={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":h},services:{"*":h},websites:{"*":h}},c(e,$,n)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");e.exports=n(chrome)}else e.exports=browser})?n.apply(o,r):n)||(e.exports=a)},3:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.stringIsEmpty=function(e){return!/\S/.test(e)},o.titleCase=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},o.stripTrailingSlash=function(e){return e?e.replace(/\/+$/g,""):e}},39:function(e,o,t){"use strict";var n=this&&this.__awaiter||function(e,o,t,n){return new(t||(t=Promise))((function(r,a){function s(e){try{i(n.next(e))}catch(e){a(e)}}function l(e){try{i(n.throw(e))}catch(e){a(e)}}function i(e){var o;e.done?r(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(s,l)}i((n=n.apply(e,o||[])).next())}))},r=this&&this.__generator||function(e,o){var t,n,r,a,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=o.call(e,s)}catch(e){a=[6,e],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},a=this&&this.__spreadArrays||function(){for(var e=0,o=0,t=arguments.length;o<t;o++)e+=arguments[o].length;var n=Array(e),r=0;for(o=0;o<t;o++)for(var a=arguments[o],s=0,l=a.length;s<l;s++,r++)n[r]=a[s];return n};Object.defineProperty(o,"__esModule",{value:!0});var s,l=t(1),i=t(7),c=t(3),d=chrome.runtime.getManifest(),u="stopped",p={},m="Please log in or sign up to continue.",g="Adjust your properties and run tests from the cloud. The domains filter list must be completed before you click this button.",h="Click to run JMeter test from the cloud now.",f='Set the time interval during which FollowMe\'s virtual users will start "following" your online activity. The virtual users will join randomly during this specified period.',w="Start recording",b="Resume recording",v="",x=null,k="",_="",A=[],y=[],j=[],C=[],B=[],S=[],T="eu-west-1",O=50,E=100,R=1e4,P=18e3,M=!1,I="v4",N=!1,q=i.getBackgroundPage(),D={text:"US Central (Iowa, Google)",value:"us-central1-a"},F=q.getRecorder({}),L=410,U=600;function J(){var e=$("#follow-name").val(),o=$("#regex_follow_input").val();!M||c.stringIsEmpty(e)||c.stringIsEmpty(o)?$.disableBtn("follow-record"):$.enableBtn("follow-record"),$.enableBtn("follow-reset"),$.disableBtn("follow-stop"),$.disableBtn("follow-pause"),$.disableBtn("follow-upload-jmx"),$.disableBtn("follow-report")}function V(e){$("#recording-actions").show(),!0===e&&$("#recording-actions").addClass("opened")}function G(e){$("#recording-actions").hide(),!0===e&&$("#recording-actions").removeClass("opened")}function W(e){$("#record .button_big_style > input").attr("title",e)}function z(){$.enableBtn("record"),$.enableBtn("reset"),$.disableBtn("pause"),$.disableBtn("stop"),$.disableBtn("edit"),$.disableBtn("debugger"),$.disableBtn("download"),$.disableBtn("upload"),$.disableBtn("upload-jmx"),$.disableBtn("upload-functional"),G(),W(w)}function Y(e){e?($("#button-edit-jmeter").show(),$("#button-edit-selenium").hide(),$("#button-upload-jmeter").show(),$("#button-upload-selenium").hide(),$.enableDropdownBtn("button-upload-jmeter-dropdown"),$.enableDropdownBtn("button-upload-functional-dropdown"),$.enableDropdownBtn("button-upload-combined-dropdown"),$.enableDropdownBtn("button-edit-jmeter-dropdown")):($("#button-edit-jmeter").hide(),$("#button-edit-selenium").show(),$("#button-upload-jmeter").hide(),$("#button-upload-selenium").show(),$.disableDropdownBtn("button-upload-jmeter-dropdown"),$.disableDropdownBtn("button-upload-functional-dropdown"),$.disableDropdownBtn("button-upload-combined-dropdown"),$.disableDropdownBtn("button-edit-jmeter-dropdown"))}chrome.storage.local.set({selected_domains:{}}),chrome.storage.local.get("server",(function(e){return k=e.server})),$(document).ready((function(){$.getJSON(q.configFile,(function(e){q.googleAnalytics("create",e.GA_code,"auto"),q.googleAnalytics("set","checkProtocolTask",null)})),$("#load-origin").chosen(),$("#parallel-downloads-list").chosen({width:"245px"});var e=new Swiper(".swiper-container",{simulateTouch:!1,effect:"fade",init:!1});function o(){chrome.tabs.query({},(function(e){for(var o=0,t=e;o<t.length;o++){var n=t[o];chrome.tabs.sendMessage(n.id,{msg:"removeTransactionPopup"})}}))}e.on("init",(function(){!function(){try{new ResizeObserver((function(e){for(var o=0,t=e;o<t.length;o++){var n=t[o];if(!$("#run-overlay").is(":visible")){$("html,body").scrollTop(0);var r=n.contentRect.height;window.parent.postMessage({height:r},"*")}}})).observe(document.querySelector(".swiper-slide-active"))}catch(e){$(".swiper-slide-active").on("resize",(function(){if(!$("#run-overlay").is(":visible")){var e=$(this).height();window.parent.postMessage({height:e},"*")}}))}}()})),e.init(),$("html, body").css({height:"auto"}),q.functionalIconBlinkMode=!1;var t=$(".regex-wrapper"),i=$(".swiper-slide-next");function H(){var e=$("#user-agent-wrapper"),o=$("#origin-wrapper"),t=$("#concurrency-wrapper");"mode-follow"===v?(o.show(),t.show(),e.addClass("test-options-position-absolute"),o.addClass("test-options-position-absolute")):(o.hide(),t.hide(),e.removeClass("test-options-position-absolute"),o.removeClass("test-options-position-absolute"))}function Z(){chrome.storage.local.get(null,(function(e){var o,t=e.concurrency,n=$("#concurrency"),r=e.account_plan.concurrency,a=(o=e.location,y.find((function(e){return e.id===o})));a&&a.limits&&a.limits.concurrency<r&&(r=a.limits.concurrency),"mode-record"===v&&r>P&&(r=P),"mode-follow"===v&&r>R&&(r=R),r<t?(q.localSave({concurrency:r}),n.slider("option","value",r),n.slider("option","max",r),q.localSave({real_max_follow_limit:r}),$("#concurrency-display-textfield").val(r)):(n.slider("option","value",t),n.slider("option","max",r),q.localSave({real_max_follow_limit:r}),$("#concurrency-display-textfield").val(t)),n.slider({disabled:!1})}))}t.on("focusin",(function(){i.css({display:"none"})})),t.on("focusout",(function(){i.css({display:"block"})})),setTimeout(H,100),chrome.storage.local.get((function(e){e.hasOwnProperty("permissionsBlockFirstTimeShow")&&e.permissionsBlockFirstTimeShow&&chrome.storage.local.set({permissionsBlockFirstTimeShow:!1})})),document.querySelectorAll(".notification-text-alert .close-open-button.open-button").forEach((function(e){e.onclick=function(){var o=e.closest(".notification-text-alert-inner"),t=o.querySelector(".notification-text-hide-block"),n=o.querySelector(".close-open-button.close-button");$(t).fadeIn(300),$(e).fadeOut(100),$(n).css("display","flex").fadeIn(300)}}));var X=document.querySelectorAll(".notification-text-alert .close-open-button.close-button");function Q(){X.forEach((function(e){return e.onclick()}))}function K(e){q.localSave({accountOptions:{account:s.accountId,workspace:s.workspaceId,project:s.id,uid:x}}),e&&($("#account-status").text(""),$("#options-fieldset-test").removeClass("not-saved"),$("#accounts").val(s.accountId).trigger("chosen:updated"),N=!1,oe(s.accountId),le(s.accountId,s.workspaceId),$(".account-loader").show(),$(".account-expand").hide())}function ee(e){$.ajax({type:"GET",contentType:"application/json",url:k+"/api/"+I+"/projects?workspaceId="+e+"&limit=1000&"+q.ApiClientIdentification(),dataType:"json",success:function(o){var t=o.result,n=$("#projects");n.empty(),$.each(t,(function(o,t){t.workspaceId===e&&(n.append('<option class="'+t.workspaceId+'" value="'+t.id+'">'+t.name+"</option>"),S.push(t.id))})),n.chosen({width:"170px"}),N?n.val($("#projects option:first").val()).trigger("chosen:updated"):chrome.storage.local.get("accountOptions",(function(e){e.hasOwnProperty("accountOptions")&&x===e.accountOptions.uid&&e.accountOptions.account&&e.accountOptions.workspace&&e.accountOptions.project?$("#projects").val(e.accountOptions.project).trigger("chosen:updated"):($("#projects").val(s.id).trigger("chosen:updated"),K(!1)),$(".project-name").text($("#projects option:selected").text())})),ae(!0)},error:function(e){te(e)}})}function oe(e){$.ajax({type:"GET",contentType:"application/json",url:k+"/api/"+I+"/workspaces?limit=0&skip=0&accountId="+e+"&enabled=true?"+q.ApiClientIdentification(),dataType:"json",success:function(o){var t=o.result,n=$("#workspaces"),r=!1;n.empty(),$.each(t,(function(o,t){t.accountId===e&&(n.append('<option class="'+t.accountId+'" value="'+t.id+'">'+t.name+"</option>"),B.push(t.id))})),n.chosen({width:"170px"}),N?(n.val($("#workspaces option:first").val()).trigger("chosen:updated"),ee(Number(n.val()))):chrome.storage.local.get("accountOptions",(function(e){e.hasOwnProperty("accountOptions")&&x===e.accountOptions.uid&&e.accountOptions.account&&e.accountOptions.workspace&&e.accountOptions.project?(ee(e.accountOptions.workspace),$("#workspaces").val(e.accountOptions.workspace).trigger("chosen:updated")):r=!0,r&&(ee(s.workspaceId),$("#workspaces").val(s.workspaceId).trigger("chosen:updated"),K(!1))}))},error:function(e){te(e)}})}function te(e){ae(!0),e.responseJSON.hasOwnProperty("error")&&$(".account-expand").html('<p class="account-options-error">Error loading account! <br>'+e.responseJSON.error.message+"</p>")}function ne(){var e=!1;$.ajax({type:"GET",contentType:"application/json",url:k+"/api/"+I+"/accounts?"+q.ApiClientIdentification(),dataType:"json",success:function(o){var t=o.result,n=$("#accounts");n.empty(),$.each(t,(function(e,o){n.append('<option value="'+o.id+'">'+o.name+"</option>"),C.push(o.id)})),n.chosen({width:"170px"}),chrome.storage.local.get("accountOptions",(function(o){o.hasOwnProperty("accountOptions")&&x===o.accountOptions.uid&&o.accountOptions.account&&o.accountOptions.workspace&&o.accountOptions.project?(oe(o.accountOptions.account),$("#accounts").val(o.accountOptions.account).trigger("chosen:updated"),le(o.accountOptions.account,o.accountOptions.workspace),ie(o.accountOptions.project)):e=!0,e&&(oe(s.accountId),le(s.accountId,s.workspaceId),ie(s.id),$("#accounts").val(s.accountId).trigger("chosen:updated"),K(!1))}))},error:function(e){return te(e)}})}function re(e,o){e?e.length>8&&(e=$.trim(e).substring(0,8).slice(0,-1)+"..."):e="user";var t=$("#signed-block");$("#sign-block").hide(),t.show(),t.html("<div class='welcome'>Hi <a href='"+k+"/app' target='_blank'>"+e+"</a></div>"),$(".welcome a").on("click",(function(){q.mixpanelTrack("CE User Name Clicked")})),chrome.storage.local.set({logged:!0,username:e,uid:o}),x=o,M=!0,chrome.extension.sendMessage({op:"reloadoptions"}),$("#update-settings").is(":checked")?($("#button-upload-jmeter input").attr("title",g),$("#upload-off input").attr("title",m)):($("#button-upload-jmeter input").attr("title",h),$("#upload-off input").attr("title",h),$("#follow-record-off input").attr("title",g)),c.stringIsEmpty($("#follow-name").val())&&!c.stringIsEmpty($("#regex_follow_input").val())&&"stopped"===u&&$.enableBtn("follow-record"),chrome.extension.sendRequest({type:"get_status"},(function(e){u=e.op,chrome.extension.sendRequest({type:"traffic_exists"},(function(e){chrome.storage.local.get("record_name",(function(o){e&&"stopped"===u&&o.record_name&&!c.stringIsEmpty(o.record_name)&&(M&&$.enableBtn("upload"),$.enableBtn("upload-jmx"))}))}))}))}function ae(e){e?($(".account-loader").hide(),$(".account-expand").show()):($(".account-loader").show(),$(".account-expand").hide())}function se(){y.length>0&&("follow"!==u&&"pause"!==u&&M?Z():$("#concurrency").slider({disabled:!1}))}function le(e,o){$.ajax({type:"GET",contentType:"application/json",url:k+"/api/"+I+"/accounts/"+e+"?"+q.ApiClientIdentification(),dataType:"json",success:function(e){chrome.storage.local.get(null,(function(){var t,n=e.result,r=n.plan.concurrency,a=Math.min(r,R);q.localSave({account_plan:n.plan,duration:n.plan.duration,real_max_follow_limit:a,features:n.features}),t=o,$.ajax({type:"GET",contentType:"application/json",url:k+"/api/"+I+"/workspaces/"+t+"?"+q.ApiClientIdentification(),dataType:"json",success:function(e){var o=e.result.locations;$("#load-origin").html(""),y=[],j=[],o.forEach((function(e){!1===e.sandbox&&(y.push({title:e.title,id:e.id,limits:e.limits}),e.hasOwnProperty("purposes")&&e.purposes.functional&&j.push({title:e.title,id:e.id,limits:e.limits}))})),$("#functional-test").is(":checked")&&"mode-follow"!==v?Be():Se(),$("#load-origin").trigger("chosen:updated")},error:function(){$.elementStatus.html("Error loading locations!")}}),chrome.extension.sendRequest({type:"get_status"},(function(e){if("stopped"!==(u=e.op)&&("mode-follow"===v||"mode-record"===v&&"mode-follow"===_))chrome.storage.local.get("max_concurrent_users",(function(e){e.max_concurrent_users}));else{var o={max_follow_limit:Math.min(n.plan.concurrency,R),max_record_limit:Math.min(n.plan.concurrency,P)};q.localSave(o),"mode-follow"===v?o.max_follow_limit:o.max_record_limit}}))}))}})}function ie(e){$(".project-name").text($("#projects option:selected").text()),$.ajax({type:"GET",contentType:"application/json",url:k+"/api/"+I+"/tests?projectId="+e+"&"+q.ApiClientIdentification(),dataType:"json",success:function(e){return function(e){A=[];var o=[],t=[],n=$("#functional-test").is(":checked");e.result.forEach((function(e){var r=e.configuration.type;"followme"===r?(o.push({value:e.name+" (id: "+e.id+")",test_id:e.id}),A[e.id]=e.name+" (id: "+e.id+")"):("taurus"!==r||n)&&("functionalApi"!==r||n)||(t.push({value:e.name+" (id: "+e.id+")",test_id:e.id}),A[e.id]=e.name+" (id: "+e.id+")")})),$.elementName.autocomplete({lookup:t,lookupLimit:5,onSelect:function(e){var o=e.value;q.localSave({record_name:o}),F.updateSuiteName(o),chrome.storage.local.set({record_id:e.test_id}),q.mixpanelTrack("CE Autocomplete Record Test Selected"),console.log("something happend??")}}),$("#follow-name").autocomplete({lookup:o,lookupLimit:5,onSelect:function(e){var o=e.value;q.localSave({test_name:o,jmxname:o}),q.mixpanelTrack("CE Autocomplete FollowMe Test Selected")}})}(e)}})}function ce(e){var o=10;e<=1e3&&e>100?o=20:e<=1e4&&e>1e3?o=60:e>1e4&&(o=300),de(o,!0),q.localSave({auto_time_distribution:o})}function de(e,o){var t;if(e<60)t=e+"s";else{var n=Math.floor(e/60),r=e-60*n;t=n+"m "+r+"s",r<1&&(t=n+"m ")}o&&(t+=" Auto"),$(".time-distribution-display .text").html(t)}function ue(e){var o=$("#concurrency-display-textfield");isNaN(e)&&(e=O,o.val(O)),o.val(e)}function pe(e){chrome.storage.local.get("time_distribution",(function(o){q.localSave({concurrency:e}),0===o.time_distribution&&ce(e)}))}function me(){chrome.storage.local.get(null,(function(e){chrome.storage.local.get(null,(function(o){var t,n,r,a=$(".onoffswitch-checkbox");"TRUE"===o.disable_followme&&(v="mode-record",chrome.storage.local.set({mode:v}),chrome.extension.sendRequest({type:"switch_mode"})),n=!1,q.cRecorder.currentSuite&&(n=!0),"mode-record"===v&&n&&"stopped"===u?V(!1):G(!0),"mode-follow"===v?(t="max_follow_limit",$(".time-distribution-wrapper").show(),$("#follow-wrapper").show(),$("#record-wrapper").hide(),$(".domains-to-follow-wrapper").show(),a.val("mode-follow"),a.attr("checked","checked"),$(".update-settings-wrapper").hide(),$(".cookie-wrapper").hide(),$(".record-cookies-wrapper").hide(),$(".random-think-time-wrapper").show(),$(".css-wrapper").hide(),$(".js-wrapper").hide(),$(".images-wrapper").hide(),$(".ajax-wrapper").hide(),$(".functional-test-wrapper").hide(),$(".other-wrapper").hide(),$(".regex-wrapper").hide(),$(".autolabel-transactions-wrapper").hide(),$(".top-level-wrapper").hide(),$(".following-wrapper").hide(),$(".following").show(),$(".parallel-downloads-wrapper").hide(),$(".parallel-downloads-text").hide(),$(".requests").hide(),$(".transactions-wrapper").hide(),$(".following").addClass("followme"),$("#test-configuration").addClass("followmode"),$("#test-configuration").removeClass("recordmode"),$("#advanced-options").addClass("followmode"),$("#advanced-options").removeClass("recordmode"),$(".regex-follow-wrapper").show(),$(".mode-record").attr("id","not-current"),$(".mode-follow").attr("id","current"),$("#mode").val("mode-record"),$("#functional-test").is(":checked")&&Se()):(t="max_record_limit",$("#record-wrapper").show(),$(".domains-to-follow-wrapper").hide(),$("#test-configuration").addClass("recordmode"),$("#test-configuration").removeClass("followmode"),$("#advanced-options").addClass("recordmode"),$("#advanced-options").removeClass("followmode"),$(".time-distribution-wrapper").hide(),$(".top-level-wrapper").show(),$(".following-wrapper").show(),$(".transactions-wrapper").show(),$("#follow-wrapper").hide(),$("#add-concurrency").hide(),a.val("mode-record"),a.removeAttr("checked"),$(".update-settings-wrapper").show(),$(".cookie-wrapper").show(),$(".record-cookies-wrapper").hide(),$(".random-think-time-wrapper").show(),$(".css-wrapper").show(),$(".js-wrapper").show(),$(".images-wrapper").show(),$(".ajax-wrapper").show(),$(".functional-test-wrapper").show(),"top_level_and_following"!==$("input[name='requests_to_record']:checked").val()&&($(".following").hide(),$(".parallel-downloads-wrapper").show(),"other"===$("#parallel-downloads-list").find(":selected").val()&&$(".parallel-downloads-text").show()),$("#edit-transaction-labels").is(":checked")&&($(".autolabel-transactions-wrapper").show(),$(".swiper-container").css({overflow:"visible"})),$(".requests").show(),$(".following").removeClass("followme"),$(".other-wrapper").show(),$(".regex-follow-wrapper").hide(),$(".regex-wrapper").show(),$(".mode-record").attr("id","current"),$(".mode-follow").attr("id","not-current"),$("#mode").val("mode-follow"),$("#functional-test").is(":checked")&&Be(),$("#advanced-options").hasClass("openedRecord")?Ce():je(),$("#recording-actions").hasClass("opened")&&V(!1)),e=e||{};var s,l=$("#concurrency"),i=l.slider("option","value");if("stopped"===u||"mode-follow"!==v){if("stopped"===u&&"mode-follow"===v&&M)s=e.real_max_follow_limit;else if(M&&"mode-follow"===v)r=E;else if(!(r=e[t]))return;var c=Math.min(i,r);l.slider("option","value",c),"mode-follow"===v&&r!==s&&"stopped"===u&&M||$("#add-concurrency").hide(),ue(c),pe(c),"0"===e.time_distribution?ce(i):(de(e.time_distribution),$("#time-distribution").slider("option","value",e.time_distribution))}else chrome.storage.local.get("max_concurrent_users",(function(e){l.slider("option","max",e.max_concurrent_users);var o=Math.min(i,e.max_concurrent_users);l.slider("option","value",o),$("#concurrency-display-textfield").val(o),ue(o),pe(o),q.localSave({concurrency:o}),$("#add-concurrency").hide()}))})),se(),H()})),"mode-follow"===v&&document.getElementById("mode").click()}function ge(){chrome.storage.local.get(null,(function(e){k=e.server,setTimeout((function(){$(".main_popup").show(),$(".loader").hide()}),1500),$(".welcome a").attr("href",k+"/app/")}))}function $e(e){$(".loader").show(),$(".main_popup").hide(),q.localSave({theme:e,accountOptions:{account:null,workspace:null,project:null,uid:x}}),chrome.extension.sendMessage({op:"themeChanged",theme:e}),function(e,o){for(var t="js"===o?"script":"css"===o?"link":"none",n="js"===o?"src":"css"===o?"href":"none",r=document.getElementsByTagName(t),a=r.length;a>=0;a--)r[a]&&null!=r[a].getAttribute(n)&&-1!==r[a].getAttribute(n).indexOf(e)&&r[a].parentNode.removeChild(r[a])}("popup.css","css"),"blazemeter"!==e?$.getJSON("/config_"+e+".json",(function(e){$.selectTheme(e)})):$.getJSON(q.configFile,(function(e){$.selectTheme(e)})),"mode-follow"===v&&$(".onoffswitch-checkbox").trigger("click")}function he(){var e=$("#signed-block"),o=$("#concurrency"),t=$("#concurrency-display-textfield");$("#options-fieldset-test").addClass("disabled-section"),$(".main_popup").show(),$(".loader").hide(),$("#sign-block").show(),e.hide(),e.html(""),o.slider({disabled:!1}),t.val()&&"null"!==t.val()||(t.val(O),o.slider("value",O)),q.localSave({real_max_follow_limit:E}),chrome.storage.local.set({logged:!1}),chrome.extension.sendMessage({op:"reloadoptions"}),M=!1,$.disableBtn("upload"),$.disableBtn("upload-jmx"),$.disableBtn("follow-upload-jmx"),$.disableBtn("follow-report"),$.disableBtn("follow-record"),$("#upload-off input").attr("title",m),$("#follow-record-off input").attr("title",m),$("#upload-jmx-off input").attr("title",m),$(".signup").attr("href",k+"/app/sign-up?app=chrome&ver="+d.version),$(".login").attr("href",k+"/app/sign-in?app=chrome&ver="+d.version),q.localSave({accountOptions:{account:null,workspace:null,project:null,uid:null},account_plan:null,account_info:null,features:null}),q.mixpanel.reset()}function fe(e,o){$.ajax({type:"GET",contentType:"application/json",url:e+"/api/"+I+"/user?"+q.ApiClientIdentification(),dataType:"json",success:function(o){q.localSave({server:e,account_info:o.result}),setTimeout((function(){$.elementStatus.html("")}),2500),ge(),chrome.storage.local.get("theme",(function(t){"https://loadtest.dynatrace.com"===e&&"dynatrace"!==t.theme?$e("dynatrace"):"https://loadtest.dynatrace.com"!==e&&"blazemeter"!==t.theme&&$e("blazemeter"),ne(),re(o.result.name,o.result.id),s=o.result.defaultProject,me(),q.googleAnalytics("set","dimension1",d.version),q.googleAnalytics("set","dimension2",t.theme),q.googleAnalytics("set","dimension3",e),q.googleAnalytics("send","pageview","main.html")}))},error:function(){console.log("userLoad error"),he(),o||"https://loadtest.dynatrace.com"===e?chrome.storage.local.get("theme",(function(o){q.googleAnalytics("set","dimension1",d.version),q.googleAnalytics("set","dimension2",o.theme),q.googleAnalytics("set","dimension3",e),q.googleAnalytics("send","pageview","main.html"),console.log("userLoad error if 2")})):($("#options-fieldset-test").removeClass("disabled-section"),we(!0),console.log("userLoad error if 1"))}})}function we(e){chrome.storage.local.get(null,(function(o){o.custom_server?fe(o.server,o.custom_server):e?$.getJSON("/config_dynatrace.json",(function(e){fe(e.server_url,o.custom_server)})):$.getJSON(q.configFile,(function(e){fe(e.server_url,o.custom_server)}))}))}function be(){p.regex_include=$("#regex_include").val(),p.regex_follow_input=$("#regex_follow_input").val(),p.requests_to_record=$("input[name='requests_to_record']:checked").val(),"mode-record"===v?(p.cookie=$("#cookie").is(":checked"),$("#record-cookies").prop("checked",p.cookie),p.random_think_time=$("#random-think-time").is(":checked"),$("#random-think-time").prop("checked",p.random_think_time)):(p.cookie=$("#record-cookies").is(":checked"),p.cookie?$("#cookie").prop("checked",!0):$("#cookie").prop("checked",!1)),p.cache=$("#cache").is(":checked"),p.service_workers=$("#service-workers").is(":checked"),p.update_settings=$("#update-settings").is(":checked"),p.record_css=$("#record-css").is(":checked"),p.record_js=$("#record-js").is(":checked"),p.record_images=$("#record-images").is(":checked"),p.record_ajax=$("#record-ajax").is(":checked"),p.functional_test=$("#functional-test").is(":checked"),p.record_redirects=$("#record-redirects").is(":checked"),p.record_other=$("#record-other").is(":checked"),p.edit_transaction_labels=!0,p.autolabel_transactions=$("#autolabel-transactions").is(":checked"),q.localSave({options:p})}function ve(){u="pause",W(b),"mode-follow"===v?q.mixpanelTrack("CE Pause FollowMe Test"):q.mixpanelTrack("CE Pause Recording"),chrome.extension.sendRequest({type:"pause_traffic"},(function(){"mode-record"===_?$.enableBtn("record"):($.enableBtn("follow-record"),$.disableBtn("record"),_="mode-follow"),chrome.storage.local.set({start_recording_mode:_}),$.disableBtn("pause"),$.enableBtn("reset"),$.disableBtn("follow-pause"),$.elementStatus.html("Recording paused!"),$("#cookie, #record-js, #record-css, #record-other, #record-images, #record-ajax").prop("disabled",!1),$('input:radio[name="requests_to_record"]').prop("disabled",!1)})),"mode-record"===v&&l.browser.runtime.sendMessage({command:"pause_recording"}).catch((function(e){console.log("Failed pausing recorder: "),console.log(e)}))}function xe(){q.mixpanelTrack("CE Edit Recording Before Upload"),chrome.tabs.create({url:"dist/editor.html"})}function ke(){q.mixpanelTrack("CE-Selenium debug and edit"),l.browser.windows.getCurrent().then((function(e){l.browser.runtime.sendMessage({command:"setReplayWindowId",replayWindowId:e.id})})).then((function(){chrome.runtime.sendMessage({command:"get_debuggerTab"},(function(e){chrome.storage.local.get("position-debugger",(function(o){var t=0,n=0;if(o["position-debugger"]&&(t=o["position-debugger"].left,n=o["position-debugger"].top),e.debuggerTab){var r=e.debuggerTab.id;chrome.tabs.get(r,(function(e){chrome.runtime.lastError?(console.log(chrome.runtime.lastError.message),q.openPopup("html/debugger.html",L,U,(function(){_e()}),t,n)):chrome.windows.update(e.windowId,{focused:!0},(function(){_e()}))}))}else q.openPopup("html/debugger.html",L,U,(function(){_e()}),t,n)}))}))}))}function _e(){window.top&&window.top.close()}function Ae(e){$.elementStatus.html("Creating test..");var o=$("#load-origin").val();q.localSave({location:o});var t=$.elementName.val(),n=null;A.forEach((function(e,o){e===t&&(n=o)})),q.localSave({record_name:t}),chrome.storage.local.set({record_id:n}),$("#advanced-options-fieldset").removeClass("opened"),$("#advanced-options").hide(),be(),chrome.extension.sendRequest({type:"upload_traffic",testType:e.data.testType})}function ye(){q.mixpanelTrack("CE Export Jmeter"),chrome.storage.local.get("mode",(function(e){"mode-follow"===e.mode?chrome.extension.sendRequest({type:"export_jmeter_follow"}):chrome.extension.sendRequest({type:"export_jmeter"})}))}function je(){$(".openclose").attr("id","closed"),$("#advanced-options-fieldset").removeClass("opened"),$("#advanced-options").hide(),Q()}function Ce(){$(".openclose").attr("id","opened"),$("#advanced-options-fieldset").addClass("opened"),$("#advanced-options").show(),$(".swiper-container").css({overflow:"visible"}),Q()}function Be(){$("#load-origin").html(""),j.forEach((function(e,o){$("#load-origin").append($("<option>").text(e.title).attr("value",e.id)),0===o&&$("#load-origin").val(e.id)})),$("#load-origin").trigger("chosen:updated");var e=$("#concurrency");e.slider("option","value",1),e.slider("option","max",1),$("#concurrency-display-textfield").val(1),e.slider({disabled:!0})}function Se(){chrome.storage.local.get("location",(function(e){var o=!1;$("#load-origin").html(""),Object.keys(y).length>0?(y.forEach((function(t){$("#load-origin").append($("<option>").text(t.title).attr("value",t.id)),e.location===t.id&&(o=!0)})),e.location&&o?$("#load-origin").val(e.location):($("#load-origin").val(T),q.localSave({location:T})),se()):$("#load-origin").append($("<option>").text(D.text).attr("value",D.value)),$("#load-origin").trigger("chosen:updated")}))}function Te(){return n(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return q.mixpanelTrack("CE-Selenium Download Yaml file"),[4,Ee().then((function(e){return downloadSuiteScript(e,{language:"yaml"})}))];case 1:return e.sent(),[2]}}))}))}function Oe(e,o){return n(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return q.mixpanelTrack("CE-Selenium Download Yaml file"),[4,Ee()];case 1:return t=n.sent(),[4,downloadSuiteScript(t,{language:e,fileFormat:o})];case 2:return n.sent(),[2]}}))}))}function Ee(){return new Promise((function(e,o){l.browser.runtime.sendMessage({command:"getCurrentSuite"}).then((function(t){t.suite?e(t.suite):o()}))}))}function Re(){var e=a($('.download-body .checkbox-wrapper input:not([name="domains"]):not(#chk-all)')).reduce((function(e,o){if("chk-jmx"===$(o).prop("name")){var t=$("input[name=domains]:checked").length>0;return $(o).prop("checked")?Number(t)+e:e}return $(o).prop("checked")?e+1:e}),0);!function(){var e=a($(".download-body .include-language input")).reduce((function(e,o){return $(o).prop("checked")?e+1:e}),0),o=a($('.download-body .checkbox-wrapper input[name="domains"]')),t=o.length;console.log(e,o,t);var n=o.reduce((function(e,o){return $(o).prop("checked")?e+1:e}),0);$("#domains-counter").text(n),$("#alldomains").text(t),$("#languages-counter").text(e)}(),e?$("#run-overlay .download-button").removeAttr("disabled").removeClass("disabled").text("Save ("+e+")"):$("#run-overlay .download-button").attr("disabled","disabled").addClass("disabled").text("Save ("+e+")")}X.forEach((function(e){e.onclick=function(){var o=e.closest(".notification-text-alert-inner"),t=o.querySelector(".notification-text-hide-block"),n=o.querySelector(".close-open-button.open-button");$(t).fadeOut(300),$(n).fadeIn(100),$(e).fadeOut(300)}})),actionDropdownOpenerListener(),$("#accounts, #workspaces, #projects").on("change",(function(){$("#options-fieldset-test").addClass("not-saved"),$("#save_test_options").prop("disabled",!1),$(".back-to span").html("Cancel"),"accounts"===$(this).attr("id")?($("#account-status").text(""),$(".account-loader").show(),$(".account-expand").hide(),N=!0,oe(Number($(this).val()))):"workspaces"===$(this).attr("id")&&($("#account-status").text(""),$(".account-loader").show(),$(".account-expand").hide(),N=!0,ee(Number($(this).val())))})),$("#save_test_options").on("click",(function(e){e.preventDefault(),chrome.storage.local.get("accountOptions",(function(e){var o=e.accountOptions;q.mixpanelTrack("CE Account Options Saved");var t=Number($("#accounts").val()),n=Number($("#workspaces").val()),r=Number($("#projects").val());o.account!==t&&q.mixpanelTrack("CE Account Changed",{Value:$("#accounts option:selected").text()}),o.workspace!==n&&q.mixpanelTrack("CE Workspace Changed",{Value:$("#workspaces option:selected").text()}),o.project!==r&&q.mixpanelTrack("CE Project Changed",{Value:$("#projects option:selected").text()}),$("#save_test_options").prop("disabled",!0),$("#options-fieldset-test").removeClass("not-saved"),r>0?(q.localSave({accountOptions:{account:t,workspace:n,project:r,uid:x}}),le(t,n),ie(r),$("#account-status").html('<span class="message">Account Options saved!</span>'),$(".back-to span").html("Go back")):($("#save_test_options").prop("disabled",!1),n>0?$("#account-status").html('<span class="error">Workspace has no project. Please choose another one.</span>'):$("#account-status").html('<span class="error">Account has no workspace. Please choose another one.</span>'))}))})),$("input[name='requests_to_record']").on("change",(function(){switch($(this).val()){case"top_level":$(".following").hide(),$(".parallel-downloads-wrapper").show(),"other"===$("#parallel-downloads-list").find(":selected").val()&&$(".parallel-downloads-text").show(),$("#cookie, #record-js, #record-css, #record-other, #record-images").prop("checked",!1);break;case"top_level_and_following":$(".following").show(),$(".parallel-downloads-wrapper").hide(),$(".parallel-downloads-text").hide()}be(),q.mixpanelTrack("CE Requests to Record",{Value:$(this).val()})})),$("#edit-transaction-labels").on("change",(function(){$(".autolabel-transactions-wrapper").toggle(this.checked),this.checked&&$(".swiper-container").css({overflow:"visible"})})),$(".info-button i").on("click",(function(){$(".license-info").toggle("slide")})),chrome.storage.local.get(null,(function(e){we(!1),$("#sign-block").show(),e.time_distribution||(de(10,!0),q.localSave({time_distribution:0,auto_time_distribution:10}))})),"top_level_and_following"!==$("input[name='requests_to_record']:checked").val()&&$("#cookie, #record-js, #record-css, #record-other, #record-images").prop("checked",!1),$(".selectall").on("click",(function(){$(".include-domains :checkbox").each((function(){this.checked=!0}))})),$(".include-domains").on("click",(function(){Re()})),$(".unselectall").on("click",(function(){$(".include-domains :checkbox").each((function(){this.checked=!1}))})),$("#concurrency").slider({disabled:!0}),$("#add-concurrency").on("click",(function(){q.mixpanelTrack("CE Increase Concurrency Clicked")})),$(".version").html(d.version),$(".checkbox-wrapper input:checkbox").on("change",(function(){be(),q.mixpanelTrack("CE "+$.trim($(this).parent().text())+" checkbox changed",{Value:$(this).is(":checked")})})),$("#regex_include").on("keyup",(function(){be()})),$("#regex_include").on("change",(function(){q.mixpanelTrack("CE Filter Pattern Changed",{Value:$(this).val()})})),$("#regex_follow_input").on("change",(function(){q.mixpanelTrack("CE Domains To Follow Changed",{Value:$(this).val()})})),$("#functional-test").on("change",(function(){if(chrome.storage.local.get("accountOptions",(function(e){ie(e.accountOptions.project)})),$(this).is(":checked"))Be();else{var e=$("#concurrency");e.slider({disabled:!1}),e.slider("option","value","1"),e.slider("option","max",P),Se()}})),$.getJSON(chrome.extension.getURL("js")+"/useragentswitcher.json",(function(e){var o=[],t=$("#user-agents-list");return t.append('<option value="Current Browser">Current Browser</option>'),$.each(e,(function(e,t){if(void 0!==t.useragent&&o.push(t),void 0!==t.folder){var n=t.folder;void 0!==n.useragent&&o.push(n),$.each(n,(function(e,t){void 0!==t.useragent&&o.push(t),void 0!==t.folder&&$.each(t.folder,(function(e,t){o.push(t)}))}))}})),$.each(o,(function(e,o){if("UA List :: About"!==o._description){var n='<optgroup label="'+o._description+'">'+o._description+"</optgroup>";void 0!==o.useragent&&($.each(o.useragent,(function(e,t){var r;"string"==typeof t?(r='<option value="'+o.useragent._useragent+'">'+o.useragent._description+"</option>",n+=r):(r='<option value="'+t._useragent+'">'+t._description+"</option>",n+=r)})),t.append(n))}})),chrome.storage.local.get("options",(function(e){e.options&&e.options.useragent?$("#user-agents-list").val(e.options.useragent):$("#user-agents-list").val("Current Browser"),t.chosen()})),!1})),$(".onoffswitch-checkbox").on("click",(function(e){"stopped"!==u?e.preventDefault():(v=$(this).val(),chrome.storage.local.get("disable_followme",(function(e){"TRUE"===e.disable_followme&&(v="mode-record"),me(),chrome.storage.local.set({mode:v}),chrome.extension.sendRequest({type:"switch_mode"}),"stopped"!==u&&"pause"!==u&&($.elementStatus.html(""),$.disableBtn("record"),$.enableBtn("pause"),$.enableBtn("stop"));var o="Record";"mode-record"!==v&&(o="FollowMe"),q.mixpanelTrack("CE Record/FollowMe Switched",{Value:o})})))})),$("#concurrency-display-textfield").on("change",(function(){var e=parseInt($(this).val(),10);q.mixpanelTrack("CE Concurrency Textfield Changed",{Concurrency:e}),chrome.storage.local.get("real_max_follow_limit",(function(o){var t=parseInt(o.real_max_follow_limit,10);if(isNaN(e))e=O,$("#concurrency-display-textfield").val(O);else if("follow"===u){var n=$("#concurrency").slider("option","max");e>n&&($("#concurrency").slider("value",n),$("#concurrency-display-textfield").val(n),e=n)}e>t&&(e=t,$("#concurrency-display-textfield").val(e)),$("#concurrency").slider("value",e),q.localSave({concurrency:e})}))})),$("#load-origin").on("change",(function(){q.localSave({location:$(this).val()}),se(),q.mixpanelTrack("CE Load Origin Changed",{"Location name":$("#load-origin option:selected").text(),Value:$(this).val()})})),$("#parallel-downloads-list").on("chosen:hiding_dropdown",(function(){$("#parallel_downloads_list_chosen > div > ul > li").remove()})),$("#parallel-downloads-list").on("change",(function(e,o){q.localSave({parallelDownloadsList:$(this).val()}),"other"===$(this).val()?$(".parallel-downloads-text").show():($(".parallel-downloads-text").hide(),q.localSave({parallel_downloads:$(this).find(":selected").data("value")})),"reset"!==o&&q.mixpanelTrack("CE Parallel Number of Downloads Changed",{Name:$("#load-origin option:selected").text(),Value:$(this).val()})})),$("#cookie, #record-js, #record-css, #record-other, #record-images").on("change",(function(){$(this).is(":checked")&&$('input:radio[name="requests_to_record"]').filter('[value="top_level_and_following"]').prop("checked",!0),be()})),$("#update-settings").on("change",(function(){M&&($(this).is(":checked")?($("#button-upload-jmeter input").attr("title","Adjust test properties and run from the cloud."),$("#upload-off input").attr("title","Adjust test properties and run from the cloud.")):($("#button-upload-jmeter input").attr("title",h),$("#upload-off input").attr("title",h)))})),$(".login").on("click",(function(){q.mixpanelTrack("CE Login Clicked")})),$(".question_style").on("click",(function(){q.mixpanelTrack("CE Guide Link Clicked")})),$(".help a").on("click",(function(){q.mixpanelTrack("CE Guide Link Clicked")})),$(".signup").on("click",(function(){q.mixpanelTrack("CE Signup Clicked")})),$("#record").find("input").tooltip(),$(".onoffswitch-label").tooltip(),$("#record-off").find("input").tooltip(),$("#upload").find("input").tooltip(),$("#upload-off").find("input").tooltip(),$("#follow-record").find("input").tooltip(),$("#follow-record-off").find("input").tooltip(),$("#follow-stop").find("input").tooltip(),$("#follow-stop-off").find("input").tooltip(),$("#reset").find("input").tooltip(),$("#reset-off").find("input").tooltip(),$("#follow-reset").find("input").tooltip(),$("#follow-reset-off").find("input").tooltip(),$(".tooltip-btn").tooltip(),$("#add-concurrency").tooltip(),$(".description a").tooltip(),$(".time-distribution-wrapper label").attr("title",f),$(".time-distribution-display").attr("title",f),$(".time-distribution-wrapper label").tooltip(),$(".time-distribution-display").tooltip(),$(".description").tooltip(),$.elementName.on("change",(function(){q.mixpanelTrack("CE Test Name Changed",{Value:$(this).val()})})),$("#follow-name").on("change",(function(){q.mixpanelTrack("CE Follow Name Changed",{Value:$(this).val()})})),$.elementName.on("keyup",(function(){q.localSave({record_name:$(this).val(),jmxname:$(this).val()}),$(this).val()&&F.updateSuiteName($(this).val()),c.stringIsEmpty($.elementName.val())?($.disableBtn("edit"),$.disableBtn("debugger"),$.disableBtn("download"),$.disableBtn("upload"),$.disableBtn("upload-jmx")):($.enableBtn("edit"),$.enableBtn("download"),$.enableBtn("debugger"),M&&($.enableBtn("upload"),$.enableBtn("upload-jmx")))})),$("#parallel_downloads").on("change",(function(){var e=function(e){var o=parseInt(e.val(),10),t=parseInt(e.attr("min"),10),n=parseInt(e.attr("max"),10);return isNaN(o)?(o=t,e.val(t)):(void 0!==t&&o<t&&(o=t,e.val(t)),void 0!==n&&o>n&&(o=n,e.val(n))),o}($(this));q.mixpanelTrack("CE Parallel Downloads Changed"),q.localSave({parallel_downloads:e})})),$("#follow-name").on("keyup",(function(){if($(this).val().replace(/ /g,"").length<1)$.disableBtn("follow-record");else{q.localSave({test_name:$(this).val(),jmxname:$(this).val()});var e=$("#regex_follow_input").val();M&&e.replace(/ /g,"").length>0&&!c.stringIsEmpty(e)&&$.enableBtn("follow-record")}})),$("#regex_follow_input").on("keyup",(function(){if($(this).val().replace(/ /g,"").length<1)$.disableBtn("follow-record");else{var e=$("#follow-name").val();M&&e.replace(/ /g,"").length>0&&!c.stringIsEmpty(e)&&"stopped"===u&&$.enableBtn("follow-record")}be(),chrome.extension.sendRequest({type:"change_regex_follow_input"})})),J(),z(),G(),chrome.storage.local.get(null,(function(e){chrome.storage.local.get(null,(function(o){M=o.logged,"{}"!==JSON.stringify(e)&&(e.record_name&&$("#name").val(e.record_name),e.test_name&&$("#follow-name").val(e.test_name),e.options&&((p=e.options).regex_follow_input?$("#regex_follow_input").val(p.regex_follow_input):$("#regex_follow_input").val(""),p.regex_include?$("#regex_include").val(p.regex_include):$("#regex_include").val("http://*/*, https://*/*"),$('input:radio[name="requests_to_record"]').filter('[value="'+p.requests_to_record+'"]').prop("checked",!0),$("#cache").prop("checked",p.cache),$("#service-workers").prop("checked",p.service_workers),$("#cookie").prop("checked",p.cookie),$("#record-cookies").prop("checked",p.cookie),$("#update-settings").prop("checked",p.update_settings),$("#record-css").prop("checked",p.record_css),$("#record-js").prop("checked",p.record_js),$("#record-images").prop("checked",p.record_images),$("#record-ajax").prop("checked",p.record_ajax),$("#functional-test").prop("checked",p.functional_test),$("#record-redirects").prop("checked",p.record_redirects),$("#record-other").prop("checked",p.record_other),$("#edit-transaction-labels").prop("checked",p.edit_transaction_labels),$("#autolabel-transactions").prop("checked",p.autolabel_transactions),$("#random-think-time").prop("checked",p.random_think_time),p.edit_transaction_labels&&($(".autolabel-transactions-wrapper").show(),$(".swiper-container").css({overflow:"abort-testvisible"})),"top_level_and_following"===p.requests_to_record&&($(".following").show(),$(".parallel-downloads-wrapper").hide(),$(".parallel-downloads-text").hide())),e.parallel_downloads?$("#parallel_downloads").val(e.parallel_downloads):($("#parallel_downloads").val($("#parallel_downloads").attr("data-default")),q.localSave({parallel_downloads:$("#parallel_downloads").attr("data-default")})),e.parallelDownloadsList&&($("#parallel-downloads-list").val(e.parallelDownloadsList).trigger("chosen:updated"),"other"===e.parallelDownloadsList&&"top_level"===p.requests_to_record&&$(".parallel-downloads-text").show())),e.concurrency||q.localSave({concurrency:O}),$("#concurrency").slider({range:"max",min:1,max:P,value:e.concurrency,slide:function(e,o){ue(o.value)},change:function(e,o){pe(o.value)},stop:function(e,o){q.mixpanelTrack("CE Concurrency Slider Changed",{Concurrency:o.value})}}),$("#time-distribution").slider({range:"max",min:0,max:300,step:10,value:e.time_distribution,slide:function(e,o){var t;t=o.value,q.localSave({time_distribution:t}),chrome.storage.local.get("concurrency",(function(e){0===t?ce(e.concurrency):de(t)}))},stop:function(e,o){q.mixpanelTrack("CE Time Distribution Slider Changed",{Value:o.value})}}),"0"==e.time_distribution?ce(e.concurrency):(de(e.time_distribution),$("#time-distribution").slider("option","value",e.time_distribution)),Re(),void 0===o.mode?(v="mode-record",_="mode-record",chrome.storage.local.set({start_recording_mode:"mode-record",mode:"mode-record"})):(v=o.mode,_=o.start_recording_mode),chrome.extension.sendRequest({type:"get_status"},(function(e){u=e.op,me(),"record"===u?(W(w),$.disableBtn("record"),$.disableBtn("reset"),$.enableBtn("pause"),$.enableBtn("stop"),$("#cookie, #record-js, #record-css, #record-other, #record-images, #record-ajax, #edit-transaction-labels").prop("disabled",!0),$('input:radio[name="requests_to_record"]').prop("disabled",!0)):"follow"===u?($.disableBtn("follow-record"),$.disableBtn("follow-reset"),$.enableBtn("follow-pause"),$.enableBtn("follow-stop"),$.enableBtn("follow-report"),$("#load-origin").prop("disabled",!0).trigger("chosen:updated"),$("#follow-name").prop("disabled",!0),$("#add-concurrency").hide(),$.disableBtn("record"),$.disableBtn("reset"),$.enableBtn("pause"),$.enableBtn("stop")):"pause"===u?(W(b),$.enableBtn("follow-stop"),$("#load-origin").prop("disabled",!0).trigger("chosen:updated"),$("#follow-name").prop("disabled",!0),$.enableBtn("stop"),$.disableBtn("follow-pause"),$.enableBtn("follow-record"),$.disableBtn("pause"),$.enableBtn("reset"),$("#cookie, #record-js, #record-css, #record-other, #record-images, #record-ajax").prop("disabled",!1),$('input:radio[name="requests_to_record"]').prop("disabled",!1),$("#edit-transaction-labels").prop("disabled",!0),"mode-record"===_?$.enableBtn("record"):$.disableBtn("record")):"waiting"===u?$.waitOverlay(1):"stopped"===u?(o.test_id&&$.enableBtn("follow-report"),$("#cookie, #record-js, #record-css, #record-other, #record-images, #record-ajax, #edit-transaction-labels").prop("disabled",!1),$('input:radio[name="requests_to_record"]').prop("disabled",!1),chrome.extension.sendRequest({type:"traffic_exists"},(function(e){chrome.runtime.sendMessage({command:"getCurrentSuite"},(function(o){chrome.storage.local.get("test_name",(function(t){!e&&!o.suite||c.stringIsEmpty(t.record_name)?($.disableBtn("edit"),$.disableBtn("download"),$.disableBtn("debugger"),$.disableBtn("upload"),$.disableBtn("upload-jmx")):($("#recording-actions").addClass("opened"),"mode-record"===v&&V(!1),!e&&!q.cRecorder.currentSuite||c.stringIsEmpty($.elementName.val())?($.disableBtn("edit"),$.disableBtn("upload")):($.enableBtn("download"),$.enableBtn("edit"),M&&$.enableBtn("upload")),Y(e),o.suite?$.enableBtn("debugger"):$.disableBtn("debugger"))}))}))})),chrome.extension.sendRequest({type:"traffic_exists_follow"},(function(e){e&&($.enableBtn("follow-report"),$.enableBtn("follow-upload-jmx"))}))):($.enableBtn("record"),$.enableBtn("reset"),$.disableBtn("pause"),$.disableBtn("stop"))})),e.stopped_test&&$.testEndedOverlay()}))})),$.resetRecording=function(){u="stopped",q.mixpanelTrack("CE Reset Recording"),$.elementName.val(""),_="",$("#regex_include").removeClass("text-error"),chrome.storage.local.set({start_recording_mode:""}),$("#concurrency").slider({disabled:!0}),$(".parallel-downloads-wrapper").show(),W(w),o(),chrome.extension.sendRequest({type:"reset_traffic"},(function(){q.localSave({test_name:"",location:T,record_name:"",concurrency:O,time_distribution:0}),chrome.storage.local.set({test_id:null,record_id:null}),$("#concurrency").slider("option","value",O),$("#time-distribution").slider("option","value","0"),ce(0),$("#concurrency-textfield").val(0),q.localSave({location:T}),$("#load-origin").prop("disabled",!1).trigger("chosen:updated"),$("#follow-name").prop("disabled",!1),$("#user-agents-list").val("Current Browser"),$("#user-agents-list").trigger("chosen:updated"),chrome.storage.local.get(null,(function(e){e.test_name?$("#follow-name").val(e.test_name):$("#follow-name").val(""),J();var o=e.concurrency;$("#concurrency").slider("option","value",o),$("#concurrency-display-textfield").val(o),e.location?$("#load-origin").val(e.location):$("#load-origin").val(T)})),p.requests_to_record="top_level",p.record_ajax=!0,p.functional_test=!1,p.cookie=!1,p.record_css=!1,p.record_js=!1,p.record_images=!1,p.record_redirects=!1,p.record_other=!1,p.edit_transaction_labels=!1,p.autolabel_transactions=!1,p.cache=!0,p.service_workers=!0,p.random_think_time=!0,p.update_settings=!1,p.regex_include="http://*/*, https://*/*",p.regex_follow_input="",p.useragent="Current Browser",q.localSave({options:p,record_name:"",jmxname:"",parallel_downloads:$("#parallel_downloads").attr("data-default")}),$.elementName.val(""),$("#regex_follow_input").val(""),$("#regex_include").val(p.regex_include),$('input:radio[name="requests_to_record"]').filter('[value="'+p.requests_to_record+'"]').prop("checked",!0),$("#regex_follow_input").prop("checked",p.regex_follow_input),$("#cookie").prop("checked",p.cookie),$("#record-cookies").prop("checked",p.cookie),$("#cache").prop("checked",p.cache),$("#service-workers").prop("checked",p.service_workers),$("#update-settings").prop("checked",p.update_settings),$("#record-css").prop("checked",p.record_css),$("#record-js").prop("checked",p.record_js),$("#record-images").prop("checked",p.record_images),$("#record-ajax").prop("checked",p.record_ajax),$("#functional-test").prop("checked",p.functional_test),$("#record-redirects").prop("checked",p.record_redirects),$("#record-other").prop("checked",p.record_other),$("#edit-transaction-labels").prop("checked",p.edit_transaction_labels),$("#autolabel-transactions").prop("checked",p.autolabel_transactions),$("#random-think-time").prop("checked",p.random_think_time),$(".autolabel-transactions-wrapper").hide(),$("#parallel-downloads-list").val("Chrome").trigger("chosen:updated").trigger("change",["reset"]),$("#parallel_downloads").val($("#parallel_downloads").attr("data-default")),$(".following").hide(),je(),M&&K(!0),z(),$.elementStatus.html("Options were reset"),chrome.browserAction.setBadgeText({text:""}),$("#concurrency").slider({disabled:!1}),l.browser.runtime.sendMessage({command:"reset_recording"}).catch((function(e){console.log("Failed reseting recorder: "),console.log(e)}))}))},$.stopRecording=function(){o(),W(w),$("#user-agents-list").prop("disabled",!1).trigger("chosen:updated"),$('input:radio[name="requests_to_record"]').prop("disabled",!1),$("#cache").prop("disabled",!1),$("#service-workers").prop("disabled",!1),$("#cookie").prop("disabled",!1),$("#record-css").prop("disabled",!1),$("#record-js").prop("disabled",!1),$("#record-images").prop("disabled",!1),$("#record-ajax").prop("disabled",!1),$("#edit-transaction-labels").prop("disabled",!1),$("#record-other").prop("disabled",!1),u="stopped",chrome.extension.sendRequest({type:"stop_traffic"},(function(){chrome.storage.local.get(null,(function(e){"mode-follow"===v?($.disableBtn("follow-pause"),$.disableBtn("follow-stop"),$.enableBtn("follow-record"),$.enableBtn("follow-reset"),$("#load-origin").prop("disabled",!1).trigger("chosen:updated"),$("#follow-name").prop("disabled",!1),$("#overlay").remove()):($.disableBtn("pause"),$.disableBtn("stop"),$.enableBtn("record"),$.enableBtn("reset")),"mode-record"!==_&&($.disableBtn("follow-pause"),$.disableBtn("follow-stop"),$.enableBtn("follow-record"),$.enableBtn("follow-reset"),$("#load-origin").prop("disabled",!1).trigger("chosen:updated"),$("#follow-name").prop("disabled",!1),$("#concurrency").slider("option","max",e.real_max_follow_limit),$("#overlay").remove(),$.disableBtn("pause"),$.disableBtn("stop"),$.enableBtn("record"),$.enableBtn("reset")),chrome.extension.sendRequest({type:"traffic_exists"},(function(o){chrome.runtime.sendMessage({command:"getCurrentSuite"},(function(t){(o||t.suite)&&(c.stringIsEmpty(e.record_name)&&chrome.extension.sendRequest({type:"get_status"},(function(e){u=e.op;var o=(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1"),t=+o.substr(0,2),n=t<12?" AM":" PM";for(o=(t%12||12)+o.substr(2,6)+n;o.indexOf(":")>0;)o=o.replace(":",".");var r=$.datepicker.formatDate("mm-dd-y",new Date),a=$.elementName.val();c.stringIsEmpty(a)&&($.elementName.val("RECORD "+r+" "+o),a="RECORD "+r+" "+o),q.localSave({options:p,record_name:a,jmxname:a}),F.updateSuiteName(a)})),$.enableBtn("edit"),$.enableBtn("download"),$.enableBtn("debugger"),"mode-record"===v&&(V(!0),Y(o)),M&&($.enableBtn("upload"),$.enableBtn("upload-jmx")))}))})),chrome.extension.sendRequest({type:"traffic_exists_follow"},(function(e){e&&($.enableBtn("follow-upload-jmx"),$.enableBtn("follow-report"))})),_="",chrome.storage.local.set({start_recording_mode:""}),"mode-follow"===v?($.elementStatus.html("FollowMe test stopped!"),chrome.browserAction.setBadgeText({text:""})):$.elementStatus.html("Recording stopped!")}))})),"mode-record"===v&&l.browser.runtime.sendMessage({command:"stop_recording"}).catch((function(e){console.log("Failed stopping recorder: "),console.log(e)}))},$(".main_popup").on("click",(function(e){$("html,body").scrollTop(0),2===e.which&&e.preventDefault();var o=$(".notification-text-alert");o.is(e.target)||0!==o.has(e.target).length||Q()})),$.elementUploadJmeter.on("click",{testType:"jmeter"},Ae),$.elementUploadSelenium.on("click",{testType:"selenium"},Ae),$("#button-upload-jmeter-dropdown").on("click",{testType:"jmeter"},Ae),$("#button-upload-functional-dropdown").on("click",{testType:"functionalApi"},Ae),$("#button-upload-selenium-dropdown").on("click",{testType:"selenium"},Ae),$("#button-upload-combined-dropdown").on("click",{testType:"combinedJmeterAndSelenium"},Ae),$.elementUploadJmx.on("click",ye),$("#button-edit-jmeter").on("click",xe),$("#button-edit-selenium").on("click",ke),$("#button-edit-jmeter-dropdown").on("click",xe),$("#button-edit-selenium-dropdown").on("click",ke),$("#record-off").on("click",ve),$("#stop").on("click",$.stopRecording),$("#record").on("click",(function(){if(!function(e){for(var o=0,t=e.split(",");o<t.length;o++){var n=t[o];if(!q.validateMatchPattern(n.trim()))return!1}return!0}($("#regex_include").val()))return $.elementStatus.html("Incorrect Filter pattern!"),!1;chrome.browserAction.setBadgeText({text:""}),q.localSave({"chk-taurus":!0}),$("#regex_include").removeClass("text-error"),q.mixpanelTrack("CE Start Recording");var e=(new Date).toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1"),o=+e.substr(0,2),t=o<12?" AM":" PM";for(e=(o%12||12)+e.substr(2,6)+t;e.indexOf(":")>0;)e=e.replace(":",".");var n=$.datepicker.formatDate("mm-dd-y",new Date);if(c.stringIsEmpty($.elementName.val())){var r="RECORD "+n+" "+e;$.elementName.val(r),q.cRecorder.defaultTestName=r}q.localSave({record_name:$.elementName.val(),jmxname:$.elementName.val()}),F.updateSuiteName($.elementName.val()),_=v,chrome.storage.local.set({start_recording_mode:v}),be(),$.disableBtn("edit"),$.disableBtn("download"),$.disableBtn("debugger"),$.disableBtn("upload"),$.disableBtn("upload-jmx"),$.disableBtn("reset"),$('input:radio[name="requests_to_record"]').prop("disabled",!0),$("#cache").prop("disabled",!0),$("#service-workers").prop("disabled",!0),$("#cookie").prop("disabled",!0),$("#record-css").prop("disabled",!0),$("#record-js").prop("disabled",!0),$("#record-images").prop("disabled",!0),$("#record-ajax").prop("disabled",!0),$("#edit-transaction-labels").prop("disabled",!0),$("#record-other").prop("disabled",!0),$("#update-settings").prop((function(){be()})),$.elementStatus.html(""),$.disableBtn("record"),$.enableBtn("pause"),$.enableBtn("stop"),chrome.extension.sendRequest({type:"start_traffic"}),"stopped"===u?chrome.tabs.query({active:!0,currentWindow:!0},(function(e){if(e.length>0&&e[0].hasOwnProperty("id")){var o={command:"start_recording",suite_name:$.elementName.val(),recordingTab:e[0]};l.browser.runtime.sendMessage(o).catch((function(e){console.log("Failed starting recorder: "),console.log(e)})),window.top.close()}})):"pause"===u&&l.browser.runtime.sendMessage({command:"resume_recording"}).catch((function(e){console.log("Failed stopping recorder: "),console.log(e)})),u="record"})),$("#reset").on("click",$.resetRecording),$("#download").on("click",(function(){chrome.extension.sendRequest({type:"get_traffic"},(function(e){e=JSON.parse(e);var o={};if(jQuery.isEmptyObject(e))$("#chk-jmx").attr("disabled","disabled").prop("checked",!1),$('label[for="chk-jmx"]').text("JMeter only (JMX) - No JMeter traffic recorded"),$('label[for="chk-jmx"]').prepend($('<div class="disabled-checkbox"></div>')),$("#run-overlay .download-body .domains-body").hide(),$("#chk-taurus").attr("disabled","disabled").prop("checked",!1),$('label[for="chk-taurus"]').html("JMeter & Selenium combined (YAML) - No JMeter traffic recorded"),$('label[for="chk-taurus"]').prepend($('<div class="disabled-checkbox"></div>'));else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],a=q.parseURL(e[r].url);o[a]||(o[a]=a)}Ee().then((function(e){jQuery.isEmptyObject(e)&&($("#chk-yaml").attr("disabled","disabled").prop("checked",!1),$('label[for="chk-yaml"]').text("Selenium (YAML) - No actions recorded"))}),(function(){$("#chk-yaml").attr("disabled","disabled").prop("checked",!1),$('label[for="chk-yaml"]').text("Selenium (YAML) - No actions recorded")})),$("#chk-jmx").prop("checked")&&M&&$("#run-overlay .download-body .domains-body").show(),M||$("#chk-jmx-wrapper").hide(),$("#run-overlay .top-overlay-title").html("Download your scripts"),$.elementStatus.html(""),$.elementRunOverlayClose.off("click"),$.elementRunOverlayClose.on("click",$.closeOverlay),$.domainDownloadOverlay(o)})),q.mixpanelTrack("CE Download the Recording clicked")})),$("#chk-all").on("click",(function(){$(this).prop("checked")?$(".languages-body").show():($(".languages-body").hide(),a($(".download-body .languages-body input")).forEach((function(e){$(e).prop("checked",!1)})),Re())})),$("#chk-jmx").on("click",(function(){q.localSave({"chk-jmx":$(this).prop("checked")}),Re(),$(this).prop("checked")?$("#run-overlay .download-body .domains-body").show():$("#run-overlay .download-body .domains-body").hide()})),$(".download-body .checkbox-wrapper input").on("click",(function(){Re()})),$("#chk-taurus").on("click",(function(){q.localSave({"chk-taurus":$(this).prop("checked")}),Re()})),$("#run-overlay .download-button").on("click",(function(){return n(this,void 0,void 0,(function(){var e,o,t,n,a,s,l,i,c,d,u;return r(this,(function(r){switch(r.label){case 0:return e=$("#chk-yaml").prop("checked"),o=$("#chk-jmx").prop("checked"),t=$("#chk-taurus").prop("checked"),n=$("#chk-cs-wd-nunit").prop("checked"),a=$("#chk-cs-wd-mstest").prop("checked"),s=$("#chk-java-wd-testng").prop("checked"),l=$("#chk-java-wd-junit").prop("checked"),i=$("#chk-java-rc-junit").prop("checked"),c=$("#chk-python-wd-unittest").prop("checked"),d=$("#chk-ruby-wd-rspec").prop("checked"),u=$("#chk-xml").prop("checked"),e?[4,Te()]:[3,2];case 1:r.sent(),r.label=2;case 2:return t&&(q.mixpanelTrack("CE Download Yaml selenium and jmeter file"),event.stopPropagation(),q.getCombinedYaml().then((function(e){var o=URL.createObjectURL(e),t=q.getNameCombinedJmeterSeleniumFile();downloadFile(t,o)}))),n?[4,Oe("cs-wd-nunit","cs")]:[3,4];case 3:r.sent(),r.label=4;case 4:return a?[4,Oe("cs-wd-mstest","cs")]:[3,6];case 5:r.sent(),r.label=6;case 6:return s?[4,Oe("java-wd-testng","java")]:[3,8];case 7:r.sent(),r.label=8;case 8:return l?[4,Oe("java-wd-junit","java")]:[3,10];case 9:r.sent(),r.label=10;case 10:return i?[4,Oe("java-rc-junit","java")]:[3,12];case 11:r.sent(),r.label=12;case 12:return c?[4,Oe("python-wd-unittest","py")]:[3,14];case 13:r.sent(),r.label=14;case 14:return d?[4,Oe("ruby-wd-rspec","rb")]:[3,16];case 15:r.sent(),r.label=16;case 16:return u?[4,Oe("xml","xml")]:[3,18];case 17:r.sent(),r.label=18;case 18:return o&&M&&(q.mixpanelTrack("CE Download jmx file"),$.exportSelectedDomains()),o||$.closeOverlay(),[2]}}))}))})),$("#advanced-options-fieldset").on("click",(function(){return $("#advanced-options-fieldset").hasClass("opened")?("mode-record"===v&&$("#advanced-options").removeClass("openedRecord"),je(),q.mixpanelTrack("CE Advanced Options Closed"),!1):("mode-record"===v&&$("#advanced-options").addClass("openedRecord"),Ce(),q.mixpanelTrack("CE Advanced Options Opened"),!1)})),$(".slide-to").on("click",(function(){M&&function(e){$(".swiper-container")[0].swiper.slideTo(e),"1"===e?($(".swiper-container").css({overflow:"hidden"}),$(".back-to span").html("Cancel"),$("#account-status").text(""),q.mixpanelTrack("CE Save In Project Opened")):($(".swiper-container").css({overflow:"visible"}),q.mixpanelTrack("CE Save In Project Closed"));var o=$(".swiper-slide-active").height();window.parent.postMessage({height:o},"*")}($(this).attr("data-page"))})),$(".cancel-account").on("click",(function(){N=!1,ne(),$("#save_test_options").prop("disabled",!0)})),$("#follow-record").on("click",(function(){if(!function(e){for(var o=0,t=e.split(",");o<t.length;o++){var n=t[o];if(/(http(s?))\/\//gi.test(r=n)||!(r.search(/\./)>0))return!1}var r;return!0}($("#regex_follow_input").val()))return $.elementStatus.html("Incorrect Domains to Follow!"),!1;be(),q.localSave({jmxname:$("#follow-name").val()}),"pause"!==u?chrome.storage.local.get("concurrency",(function(e){l.browser.runtime.sendMessage({command:"reset_recording"}).catch((function(e){console.log("Failed reseting recorder: "),console.log(e)})),z(),u="waiting",$.elementStatus.html("Starting test.."),$.disableBtn("follow-report"),$.disableBtn("follow-upload-jmx"),_=v;var o=e.concurrency;$("#concurrency").slider("option","max",o);var t,n,r,a,s,i,d,p=$("#follow-name").val(),m=null;A.forEach((function(e,o){e===p&&(m=o)})),c.stringIsEmpty($("#follow-name").val())&&(p="Follow Me "+(t=new Date,n=t.getFullYear()-2e3,r=t.getMonth()+1,a=t.getDate(),s=t.getHours(),i=t.getMinutes(),d=t.getSeconds(),1===r.toString().length&&(r="0"+r),1===a.toString().length&&(a="0"+a),1===s.toString().length&&(s="0"+s),1===i.toString().length&&(i="0"+i),1===d.toString().length&&(d="0"+d),r+"/"+a+"/"+n+" "+(s<10?"0":""+(s>12?s-12:s))+":"+i+":"+d+" "+(s>12?"PM":"AM")),$("#follow-name").val(p));var g=$("#load-origin").val();q.localSave({max_concurrent_users:o,test_name:p,location:g}),chrome.storage.local.set({start_recording_mode:v,test_id:m})})):($.disableBtn("follow-record"),$.enableBtn("follow-pause"),$.enableBtn("pause")),$.disableBtn("follow-reset"),$.disableBtn("reset"),$.elementStatus.html(""),$.enableBtn("stop"),chrome.extension.sendRequest({type:"follow_traffic"})})),$("#follow-stop").on("click",$.stopRecording),$("#follow-pause").on("click",ve),$("#follow-upload-jmx").on("click",ye),$("#follow-report").on("click",(function(){q.mixpanelTrack("CE View Report"),chrome.storage.local.get(null,(function(e){var o=e.accountOptions;o&&e.testSessionId&&chrome.tabs.create({url:k+"/app/#/accounts/"+o.account+"/workspaces/"+o.workspace+"/projects/"+o.project+"/masters/"+e.testSessionId+"/summary"})}))})),$("#follow-reset").on("click",$.resetRecording),$.elementRunOverlayClose.on("click",$.closeOverlay),$("#user-agents-list").on("click",(function(){p.useragent=$(this).val(),q.localSave({options:p}),chrome.extension.sendRequest({type:"change_useragent",action:$(this).val()}),q.mixpanelTrack("CE User Agent Changed",{"User Agent":$(this).val()})})),document.querySelectorAll(".chosen-single").forEach((function(e){e.onclick=function(){Q()}})),function(){return n(this,void 0,void 0,(function(){var e,o,t,n;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,fetch("https://guide.blazemeter.com/hc/en-us/articles/115004970329-Chrome-Extension-Changelog-Chrome-Extension-Changelog")];case 1:return e=r.sent(),t=(o=new DOMParser).parseFromString,[4,e.text()];case 2:return[2,t.apply(o,[r.sent(),"text/html"]).querySelector(".article-body.markdown > p > strong").innerText.match(/[0-9.]+/)[0]];case 3:throw n=r.sent(),new Error("Cannot get latest version: "+n.message);case 4:return[2]}}))}))}().then((function(e){(function(e,o){for(var t=e.split("."),n=o.split("."),r=Math.max(t.length,n.length),a=0;a<r;a++){var s=Number(t[a])||0,l=Number(n[a])||0;if(s!==l)return s-l>0}return!1})(e,d.version)&&document.getElementById("new-version-alert").classList.remove("hidden")}))})),chrome.extension.onMessage.addListener((function(e){e.status?e.link?$.elementStatus.html(e.status+' <a href="'+e.link+'">See more.</a>'):$.elementStatus.html(e.status):e.waiting?"failed"===e.waiting?(u="stopped",J(),z(),$("#follow-name").prop("disabled",!1),$("#overlay").remove()):($.disableBtn("follow-record"),$.disableBtn("follow-reset"),$.enableBtn("follow-pause"),$.enableBtn("follow-stop"),$.enableBtn("follow-report"),$("#load-origin").prop("disabled",!0).trigger("chosen:updated"),$("#follow-name").prop("disabled",!0),$("#add-concurrency").hide(),chrome.storage.local.get("test_name",(function(e){e.test_name&&$("#follow-name").val(e.test_name)}))):"progressbar"===e.op?e.progress?(e.follow?($("#got-it:visible").length>0&&$("#got-it").hide(),$.elementRunOverlayClose.hide(),$(".test-ended-body").hide(),$.elementProgresBodyP.text("Launching servers in the cloud can take about 2 minutes."),$.elementProgresBodyH4.text("Please wait while cloud servers are being launched.")):($.elementRunOverlayClose.show(),$("#update-settings").is(":checked")?($(".text p").text(""),$(".text h4").text("Uploading your data."),$.elementRunOverlayClose.hide()):($.elementProgresBodyP.text("Launching servers in the cloud can take about 2 minutes."),$.elementProgresBodyH4.text("Please wait while cloud servers are being launched."))),null!=e.test_id?($.elementProgressButton.on("click",$.dismissTest),$.elementProgressButton.show()):($.elementProgressButton.off("click"),$.elementProgressButton.hide(),$.elementRunOverlayClose.off("click"),$.elementRunOverlayClose.on("click",$.cancelTest)),$.waitOverlay(e.progress)):($.elementRunOverlayProgress.hide(),$.closeOverlay(),e.followstopped&&chrome.storage.local.get("real_max_follow_limit",(function(e){$("#concurrency").slider("option","max",e.real_max_follow_limit)}))):"domainoverlay"===e.op?($.elementStatus.html(""),$.elementRunOverlayClose.off("click"),$.elementDomainsButton.off("click"),"upload"===e.action?($.elementRunOverlayClose.on("click",$.closeOverlay),$.elementRunOverlayClose.on("click",$.cancelTest),$.elementDomainsButton.on("click",$.uploadSelectedDomains)):"export"===e.action&&($.elementRunOverlayClose.on("click",$.closeOverlay),$.elementDomainsButton.on("click",$.exportSelectedDomains)),$.domainOverlay(JSON.parse(e.domains))):"testendedoverlay"===e.op?($.elementStatus.html(""),$.testEndedOverlay()):"test_ended_on_backend"===e.op?($.elementStatus.html(""),$(".test-ended-body .text p").text("Your FollowMe session has came to its end, please start new session"),$.testEndedOverlay()):"stop_recording"===e.op?($.stopRecording(),e.msg&&setTimeout((function(){$.elementStatus.html(e.msg)}),1e3),"filter_pattern_error"===e.action&&($("#regex_include").addClass("text-error"),q.mixpanelTrack("CE Filter Pattern Error",{Value:$("#regex_include").val()}))):"network_error"===e.op?$.resetRecording():"exportJMX"===e.op?e.exporting&&($.elementProgressButton.hide(),$.elementProgresBodyP.text(""),$.elementProgresBodyH4.text($.stringExporting),e.progress<100&&$.waitOverlay(e.progress)):"closeOverlay"===e.op||"exported_to_jmx"===e.op?$.closeOverlay():"uploadDataFailed"===e.op?($.cancelTest(),$.closeOverlay(),setTimeout((function(){$.elementStatus.html("Sending data failed. Please try again.")}),1500)):"testTerminated"===e.op?$.stopRecording():"uploadJMXFailed"===e.op&&($.closeOverlay(),$.cancelTest(),setTimeout((function(){$.elementStatus.html("Upload data failed.")}),1500))}))},7:function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.getBackgroundPage=function(){return chrome.extension.getBackgroundPage()}}});
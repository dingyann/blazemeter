!function(e){var t={};function s(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=20)}([,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),"undefined"==typeof window?t.browser={}:t.browser=s(2)},function(e,t,s){var a,r,n;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,r=[e],void 0===(n="function"==typeof(a=function(e){"use strict";if("undefined"==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype){const t="The message port closed before a response was received.",s="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",a=e=>{const a={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(a).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,t){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const n=(t,s)=>(...a)=>{e.runtime.lastError?t.reject(e.runtime.lastError):s.singleCallbackArg||a.length<=1&&!1!==s.singleCallbackArg?t.resolve(a[0]):t.resolve(a)},i=e=>1==e?"argument":"arguments",o=(e,t,s)=>new Proxy(t,{apply:(t,a,r)=>s.call(a,e,...r)});let l=Function.call.bind(Object.prototype.hasOwnProperty);const c=(e,t={},s={})=>{let a=Object.create(null),r={has:(t,s)=>s in e||s in a,get(r,u,m){if(u in a)return a[u];if(!(u in e))return;let d=e[u];if("function"==typeof d)if("function"==typeof t[u])d=o(e,e[u],t[u]);else if(l(s,u)){let t=((e,t)=>(function(s,...a){if(a.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${i(t.minArgs)} for ${e}(), got ${a.length}`);if(a.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${i(t.maxArgs)} for ${e}(), got ${a.length}`);return new Promise((r,i)=>{if(t.fallbackToNoCallback)try{s[e](...a,n({resolve:r,reject:i},t))}catch(n){console.warn(`${e} API method doesn't seem to support the callback parameter, `+"falling back to call it without a callback: ",n),s[e](...a),t.fallbackToNoCallback=!1,t.noCallback=!0,r()}else t.noCallback?(s[e](...a),r()):s[e](...a,n({resolve:r,reject:i},t))})}))(u,s[u]);d=o(e,e[u],t)}else d=d.bind(e);else if("object"==typeof d&&null!==d&&(l(t,u)||l(s,u)))d=c(d,t[u],s[u]);else{if(!l(s,"*"))return Object.defineProperty(a,u,{configurable:!0,enumerable:!0,get:()=>e[u],set(t){e[u]=t}}),d;d=c(d,t[u],s["*"])}return a[u]=d,d},set:(t,s,r,n)=>(s in a?a[s]=r:e[s]=r,!0),defineProperty:(e,t,s)=>Reflect.defineProperty(a,t,s),deleteProperty:(e,t)=>Reflect.deleteProperty(a,t)},u=Object.create(e);return new Proxy(u,r)},u=e=>({addListener(t,s,...a){t.addListener(e.get(s),...a)},hasListener:(t,s)=>t.hasListener(e.get(s)),removeListener(t,s){t.removeListener(e.get(s))}});let m=!1;const d=new r(e=>"function"!=typeof e?e:function(t,a,r){let n,i,o=!1,l=new Promise(e=>{n=function(t){m||(console.warn(s,(new Error).stack),m=!0),o=!0,e(t)}});try{i=e(t,a,n)}catch(e){i=Promise.reject(e)}const c=!0!==i&&(e=>e&&"object"==typeof e&&"function"==typeof e.then)(i);if(!0!==i&&!c&&!o)return!1;const u=e=>{e.then(e=>{r(e)},e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:t})}).catch(e=>{console.error("Failed to send onMessage rejected reply",e)})};return u(c?i:l),!0}),g=({reject:s,resolve:a},r)=>{e.runtime.lastError?e.runtime.lastError.message===t?a():s(e.runtime.lastError):r&&r.__mozWebExtensionPolyfillReject__?s(new Error(r.message)):a(r)},h=(e,t,s,...a)=>{if(a.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${i(t.minArgs)} for ${e}(), got ${a.length}`);if(a.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${i(t.maxArgs)} for ${e}(), got ${a.length}`);return new Promise((e,t)=>{const r=g.bind(null,{resolve:e,reject:t});a.push(r),s.sendMessage(...a)})},p={runtime:{onMessage:u(d),onMessageExternal:u(d),sendMessage:h.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:h.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},f={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return a.privacy={network:{"*":f},services:{"*":f},websites:{"*":f}},c(e,p,a)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");e.exports=a(chrome)}else e.exports=browser})?a.apply(t,r):a)||(e.exports=n)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringIsEmpty=function(e){return!/\S/.test(e)},t.titleCase=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},t.stripTrailingSlash=function(e){return e?e.replace(/\/+$/g,""):e}},,,,,,,,,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(1);t.delay=function(e){return new Promise((function(t){return setTimeout(t,e)}))},t.forAllTabs=function(e){a.browser.tabs.query({}).then((function(t){for(var s=0,a=t;s<a.length;s++){var r=a[s];r.url.startsWith("chrome-extension://")||r.url.startsWith("chrome://")||e(r)}}))}},,,,,,,,function(e,t,s){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,s=1,a=arguments.length;s<a;s++)for(var r in t=arguments[s])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,t,s,a){return new(s||(s=Promise))((function(r,n){function i(e){try{l(a.next(e))}catch(e){n(e)}}function o(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,o)}l((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var s,a,r,n,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function o(n){return function(o){return function(n){if(s)throw new TypeError("Generator is already executing.");for(;i;)try{if(s=1,a&&(r=2&n[0]?a.return:n[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,n[1])).done)return r;switch(a=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return i.label++,{value:n[1],done:!1};case 5:i.label++,a=n[1],n=[0];continue;case 7:n=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){i=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){i.label=n[1];break}if(6===n[0]&&i.label<r[1]){i.label=r[1],r=n;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(n);break}r[2]&&i.ops.pop(),i.trys.pop();continue}n=t.call(e,i)}catch(e){n=[6,e],a=0}finally{s=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}},i=this&&this.__spreadArrays||function(){for(var e=0,t=0,s=arguments.length;t<s;t++)e+=arguments[t].length;var a=Array(e),r=0;for(t=0;t<s;t++)for(var n=arguments[t],i=0,o=n.length;i<o;i++,r++)a[r]=n[i];return a};Object.defineProperty(t,"__esModule",{value:!0});var o=s(21),l=s(3),c=s(12),u=s(22);s(23);var m=function(){function e(e,t){this.skippedSteps=[],this.breakPoints=[],this.replayStatus="stop",this.frames=[],this.commandIndex=-1,this.caseFailed=!1,this.suite=null,this.skipNextBreakpoint=!1,this.replayDelay=500,this.virtualBreakpoints=[],this.mapper=new u.CommandMapper,this.extCommand=e,this.callbacks=t}return e.prototype.setModel=function(e){if(this.frames.length>0){var t=this.rebuildFrames(e,this.nextStepId),s=t.partial,a=t.commandIndex,r=t.frames;s?this.frames.length!==r.length&&(this.commandIndex=this.frames[r.length].lastIndex-1):this.commandIndex=a-1,this.frames=r;var n=this.findAndSaveNextStepId();this.callbacks.updateCommandStatus({status:"pending",nextStepId:n})}this.suite=e},e.prototype.next=function(){return r(this,void 0,void 0,(function(){var e,t,s;return n(this,(function(a){switch(a.label){case 0:return"pause"!==this.replayStatus&&"breakpoint"!==this.replayStatus?[2]:(this.skipNextBreakpoint=!0,(e=this.lastFrame.steps[this.commandIndex+2])?this.virtualBreakpoints.push(this.getId(e)):(t=this.frames[this.frames.length-2])&&(s=t.steps[this.lastFrame.lastIndex+1])&&this.virtualBreakpoints.push(i(this.frames.map((function(e){return e.id})).filter((function(e){return e})).slice(0,-1),[s.id])),[4,this.resume()]);case 1:return a.sent(),[2]}}))}))},e.prototype.stepIn=function(){return r(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:return"pause"!==this.replayStatus&&"breakpoint"!==this.replayStatus?[2]:(this.skipNextBreakpoint=!0,(e=this.lastFrame.steps[this.commandIndex+1]).steps?(this.virtualBreakpoints.push(i(this.frames.map((function(e){return e.id})).filter((function(e){return e})),[e.id,e.steps[0].id])),[4,this.resume()]):[3,2]);case 1:return t.sent(),[3,4];case 2:return[4,this.next()];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},e.prototype.stepOut=function(){return r(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:return"pause"!==this.replayStatus&&"breakpoint"!==this.replayStatus?[2]:(this.skipNextBreakpoint=!0,this.commandIndex!==this.lastFrame.steps.length?[3,2]:[4,this.next()]);case 1:return t.sent(),[3,4];case 2:return e=this.lastFrame.steps[this.lastFrame.steps.length-1],this.virtualBreakpoints.push(i(this.frames.map((function(e){return e.id})).filter((function(e){return e})),[e.id])),[4,this.resume()];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},e.prototype.stop=function(){this.replayStatus="stop",this.finalizePlayingProgress()},e.prototype.pause=function(){"play"===this.replayStatus&&(this.replayStatus="pause")},e.prototype.resume=function(){return r(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:if("pause"!==this.replayStatus&&"breakpoint"!==this.replayStatus)return[2];"breakpoint"===this.replayStatus&&(this.skipNextBreakpoint=!0),this.replayStatus="play",this.callbacks.switchOnReplayStatus("playing"),this.extCommand.attach(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.executionLoop()];case 2:return t.sent(),this.finalizePlayingProgress(),[3,4];case 3:return e=t.sent(),this.catchPlayingError(e),[3,4];case 4:return[2]}}))}))},e.prototype.playSuite=function(e,t){return r(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:this.callbacks.switchOnReplayStatus("playing"),this.frames.push(this.suite),t.label=1;case 1:return t.trys.push([1,4,,5]),[4,this.initializePlayingProgress()];case 2:return t.sent(),[4,this.executionLoop()];case 3:return t.sent(),this.finalizePlayingProgress(),[3,5];case 4:return e=t.sent(),this.catchPlayingError(e),[3,5];case 5:return[2]}}))}))},e.prototype.initSuite=function(){return r(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:this.frames.push(this.suite),t.label=1;case 1:return t.trys.push([1,4,,5]),[4,this.initializePlayingProgress()];case 2:return t.sent(),this.virtualBreakpoints.push(this.getFirstStepId()),[4,this.executionLoop()];case 3:return t.sent(),[3,5];case 4:return e=t.sent(),console.log("reason: ",e),this.catchPlayingError(e),[3,5];case 5:return[2]}}))}))},e.prototype.playSingleCommand=function(e){return r(this,void 0,void 0,(function(){var t,s,a,r,i,o,c,u,m,h,p,f,A,x,b,y,v,w=this;return n(this,(function(n){switch(n.label){case 0:return[4,this.initializePlayingProgress()];case 1:return n.sent(),t=this.rebuildFrames(this.suite,e),s=t.commandIndex,a=t.frames,this.frames=a,this.commandIndex=s,(r=this.findStepByPath(this.suite,e))?(i=this.mapper.map(r),o=i.command,c=i.target,u=i.value,m=1e4,"waitFor"===o&&(v=u.split(":",2),u=v[0],m=(m=v[1])||1e4),this.callbacks.updateCommandStatus({identifier:e,status:"pending"}),this.callbacks.switchOnReplayStatus("playing"),u=g(u),c=g(c),ExtCommand.isExtCommand(o)?(console.log("Executing: | "+o+" | "+c+" | "+u+" |"),this.extCommand["do"+l.titleCase(o)](c,u).then((function(){w.callbacks.updateCommandStatus({identifier:e,status:"success"})}),(function(t){var s="string"==typeof t?t:t.message;console.error("Command failed. Reason:",s),w.callbacks.updateCommandStatus({identifier:e,status:"fail",reason:s})})),this.callbacks.switchOnReplayStatus("paused"),[3,12]):[3,2]):(this.callbacks.updateCommandStatus({identifier:e,status:"fail",reason:"Step was not found"}),[2]);case 2:if(d(o))return this.callbacks.switchOnReplayStatus("paused"),[2,this.extCommand.sendCommand(o,c,u,!0)];if(h=void 0,h=c.startsWith("cache=")?[c]:i.targetOptions&&i.targetOptions.length?i.targetOptions.map((function(e){return g(e[0])})):[g(c)],"waitFor"!==o||!u.startsWith("not_"))return[3,7];p=!0,f=0,n.label=3;case 3:return f<h.length?(A=h[f],console.log("Executing: | "+o+" | "+A+" | "+u+" |"),[4,this.executeCommand(o,A,u,!1,m)]):[3,6];case 4:x=n.sent(),p=p&&"success"===x.result,n.label=5;case 5:return++f,[3,3];case 6:return p?(this.callbacks.updateCommandStatus({identifier:e,status:"success"}),this.callbacks.switchOnReplayStatus("paused"),[2]):(this.callbacks.updateCommandStatus({identifier:e,status:"fail",reason:"One of the locators has matched the element!"}),this.callbacks.switchOnReplayStatus("paused"),this.caseFailed=!0,this.commandIndex--,this.pause(),[3,12]);case 7:f=0,n.label=8;case 8:return f<h.length?(A=h[f],console.log("Executing: | "+o+" | "+A+" | "+u+" |"),[4,this.executeCommand(o,A,u,!1,m)]):[3,11];case 9:if("success"===(x=n.sent()).result)return b=0===f?void 0:A,y=this.findAndSaveNextStepId(),this.callbacks.updateCommandStatus({identifier:e,status:"success",nextStepId:y,successLocator:b}),this.callbacks.switchOnReplayStatus("paused"),[2];n.label=10;case 10:return++f,[3,8];case 11:this.callbacks.updateCommandStatus({identifier:e,status:"fail",reason:"Failed to find element using provided locators"}),this.callbacks.switchOnReplayStatus("paused"),this.caseFailed=!0,this.commandIndex--,this.pause(),n.label=12;case 12:return[2]}}))}))},e.prototype.executionLoop=function(){return r(this,void 0,void 0,(function(){var e,t,s,r,u,m,d,p,f,A,x,b,y,v,w,k,S,C,P,I,O,j,F;return n(this,(function(n){switch(n.label){case 0:return 0===this.frames.length?this.caseFailed?(this.caseFailed=!1,[2,!1]):(declaredVars={},this.callbacks.switchOnReplayStatus("stopped"),this.callbacks.successFullReplay(),[2,!0]):(this.commandIndex++,e=this.lastFrame.steps,this.commandIndex>=e.length?(this.lastFrame.loop?(t=this.lastFrame,b=t.loop,v=t.end,s=t.step,declaredVars[b]+=h(s,1),declaredVars[b]<=h(v,0)?this.commandIndex=-1:(this.commandIndex=this.lastFrame.lastIndex,this.dropLastFrame())):(this.commandIndex=this.lastFrame.lastIndex,this.dropLastFrame()),[4,this.executionLoop()]):[3,2]);case 1:return[2,n.sent()];case 2:return r=e[this.commandIndex],u=this.getId(r),this.skippedSteps.some((function(e){return o.arraysMatch(e,u)}))?[4,this.executionLoop()]:[3,4];case 3:return[2,n.sent()];case 4:return this.checkIfBreakpoint(u)?(this.commandIndex--,m=this.findAndSaveNextStepId(),this.callbacks.updateCommandStatus({status:"pending",nextStepId:m}),this.callbacks.switchOnReplayStatus("paused"),this.callbacks.updateStatus("Paused on breakpoint","info"),this.pause(),this.virtualBreakpoints=[],this.replayStatus="breakpoint",[2,Promise.reject("shutdown")]):"pause"===this.replayStatus?(this.commandIndex--,m=this.findAndSaveNextStepId(),this.callbacks.updateCommandStatus({status:"pending",nextStepId:m}),this.callbacks.switchOnReplayStatus("paused"),[2,Promise.reject("shutdown")]):"forEachLoopGroup"!==r.type?[3,13]:[4,this.doPreparation()];case 5:return n.sent(),[4,Promise.all([this.doPrePageWait(),this.doPageWait(),this.doAjaxWait(),this.doDomWait()])];case 6:return n.sent(),this.callbacks.updateCommandStatus({identifier:u,status:"pending"}),[4,c.delay(500)];case 7:n.sent(),d=void 0,p=0,f=r.target,n.label=8;case 8:return p<f.length?(A=f[p],[4,this.executeCommand("findElements",A,"")]):[3,11];case 9:if((d=n.sent()).value)return[3,11];n.label=10;case 10:return p++,[3,8];case 11:return d&&d.value?(declaredVars["obj_"+r.iterator+"_array"]=d.value.split(","),declaredVars["obj_"+r.iterator+"_index"]=0,(S=i(r.steps)).push({action:"ret",id:"deadbeef-dead-beef-dead-beefdead"}),this.frames.push(a(a({lastIndex:this.commandIndex,loop:"obj_"+r.iterator+"_index",end:declaredVars["obj_"+r.iterator+"_array"].length-1,step:1},r),{steps:S})),this.commandIndex=-1,[4,this.executionLoop()]):(this.commandIndex--,x=r.target[0],this.callbacks.updateCommandStatus({identifier:u,status:"fail",reason:"Element "+x.name.toLowerCase()+"="+x.value+" not found"}),this.callbacks.switchOnReplayStatus("paused"),this.caseFailed=!0,this.pause(),[2,Promise.reject("shutdown")]);case 12:return[2,n.sent()];case 13:return r.loop?(b=r.loop,y=r.start,v=r.end,this.callbacks.updateCommandStatus({identifier:u,status:"pending"}),declaredVars[b]=h(y,0),declaredVars[b]<=h(v,-1)&&((S=i(r.steps)).push({action:"ret",id:"deadbeef-dead-beef-dead-beefdead"}),this.frames.push(a(a({lastIndex:this.commandIndex},r),{steps:S})),this.commandIndex=-1),[4,c.delay(500)]):[3,16];case 14:return n.sent(),[4,this.executionLoop()];case 15:return[2,n.sent()];case 16:return r.steps?("ret"!==r.steps[r.steps.length-1].action&&r.steps.push({action:"ret",id:"deadbeef-dead-beef-dead-beefdead"}),this.callbacks.updateCommandStatus({identifier:u,status:"pending"}),this.frames.push(a({lastIndex:this.commandIndex},r)),this.commandIndex=-1,[4,c.delay(500)]):[3,19];case 17:return n.sent(),[4,this.executionLoop()];case 18:return[2,n.sent()];case 19:return r.if?[4,this.doPreparation()]:[3,25];case 20:return n.sent(),[4,Promise.all([this.doPrePageWait(),this.doPageWait(),this.doAjaxWait(),this.doDomWait()])];case 21:return n.sent(),this.callbacks.updateCommandStatus({identifier:u,status:"pending"}),w=g(r.if),[4,this.extCommand.sendCommand("eval",w,"")];case 22:return k=n.sent(),(S=k.value?r.then:r.else).push({action:"ret",id:"deadbeef-dead-beef-dead-beefdead"}),this.frames.push({lastIndex:this.commandIndex,id:r.id,steps:S}),this.commandIndex=-1,[4,c.delay(500)];case 23:return n.sent(),[4,this.executionLoop()];case 24:return[2,n.sent()];case 25:return"ret"!==r.action?[3,27]:(this.callbacks.updateCommandStatus({identifier:u.slice(0,-1),status:"success"}),[4,this.executionLoop()]);case 26:return[2,n.sent()];case 27:return this.callbacks.updateCommandStatus({identifier:u,status:"pending"}),C=this.mapper.map(r),P=C.command,I=C.target,O=C.value,""===P?[2,Promise.reject("no command name")]:(j=this.getDelay(P),[4,c.delay(j)]);case 28:if(n.sent(),!ExtCommand.isExtCommand(P))return[3,34];O=g(O),I=g(I),console.log("Executing: | "+P+" | "+I+" | "+O+" |"),n.label=29;case 29:return n.trys.push([29,31,,32]),[4,this.extCommand["do"+l.titleCase(P)](I,O)];case 30:return n.sent(),this.callbacks.updateCommandStatus({identifier:u,status:"success"}),[3,32];case 31:return F=n.sent(),console.log(F),this.callbacks.updateCommandStatus({identifier:u,status:"fail",reason:F}),console.log("Test case failed"),this.caseFailed=!0,this.callbacks.switchOnReplayStatus("paused"),this.commandIndex--,this.pause(),[3,32];case 32:return[4,this.executionLoop()];case 33:return[2,n.sent()];case 34:return[4,this.doPreparation()];case 35:return n.sent(),[4,Promise.all([this.doPrePageWait(),this.doPageWait(),this.doAjaxWait(),this.doDomWait()])];case 36:return n.sent(),[4,this.doCommand()];case 37:return n.sent(),[4,this.executionLoop()];case 38:return[2,n.sent()]}}))}))},e.prototype.getDelay=function(e){var t=this.replayDelay;return"assertAlert"!==e&&"assertConfirmation"!==e&&"assertPrompt"!==e&&"assertDialog"!==e||(t=50),t},e.prototype.checkIfBreakpoint=function(e){return this.skipNextBreakpoint?(this.skipNextBreakpoint=!1,!1):this.virtualBreakpoints.some((function(t){return o.arraysMatch(e,t)}))||this.breakPoints.some((function(t){return o.arraysMatch(e,t)}))},e.prototype.playAfterConnectionFailed=function(){return r(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:if("play"!==this.replayStatus)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),this.initializeAfterConnectionFailed(),[4,this.executionLoop()];case 2:return t.sent(),this.finalizePlayingProgress(),[3,4];case 3:return e=t.sent(),this.catchPlayingError(e),[3,4];case 4:return[2]}}))}))},e.prototype.initializeAfterConnectionFailed=function(){this.replayStatus="play",this.caseFailed=!1},e.prototype.initializePlayingProgress=function(){return this.replayStatus="play",this.commandIndex=-1,this.caseFailed=!1,this.extCommand.init()},e.prototype.catchPlayingError=function(e){var t=this;if(function(e){return"TypeError: response is undefined"===e||"Error: Could not establish connection. Receiving end does not exist."===e||"Could not establish connection. Receiving end does not exist."===e.message||"The message port closed before a reponse was received."===e.message||"The message port closed before a response was received."===e.message}(e))setTimeout((function(){return r(t,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return this.commandIndex--,[4,this.playAfterConnectionFailed()];case 1:return e.sent(),[2]}}))}))}),100);else if("shutdown"===e){var s=this.findAndSaveNextStepId();this.callbacks.updateCommandStatus({status:"pending",nextStepId:s}),this.callbacks.switchOnReplayStatus("paused")}else this.extCommand.clear(),console.log(e),this.commandIndex>=0&&this.callbacks.updateCommandStatus({status:"fail",reason:e}),console.log("Test case failed"),this.callbacks.failedReplay(e),this.callbacks.switchOnReplayStatus("stop"),setTimeout((function(){t.replayStatus="stop"}),500)},e.prototype.doCommand=function(){return r(this,void 0,void 0,(function(){var e,t,s,a,r,i,o,l,c,u,m,h,p,f,A,x,b,y,v,w,k,S;return n(this,(function(n){switch(n.label){case 0:if(e=this.lastFrame.steps,t=e[this.commandIndex],s=this.mapper.map(t),a=s.command,r=s.target,i=s.value,!e[this.commandIndex].iterator)return[3,6];if(o=declaredVars["obj_"+t.iterator+"_array"],l=declaredVars["obj_"+t.iterator+"_index"],c=o[l],!e[this.commandIndex].target)return[3,5];u="cache="+c,m=0,h=e[this.commandIndex].target,n.label=1;case 1:return m<h.length?(v=h[m],[4,this.executeCommand("findElements",v,u)]):[3,4];case 2:if((w=n.sent()).value)return r="cache="+w.value,[3,4];n.label=3;case 3:return m++,[3,1];case 4:return[3,6];case 5:r="cache="+c,n.label=6;case 6:return p=1e4,"waitFor"===a&&(S=i.split(":",2),i=S[0],p=(p=S[1])||1e4),"play"!==this.replayStatus?(this.commandIndex--,[2,Promise.reject("shutdown")]):[4,this.stabilizePage()];case 7:if(n.sent(),i=g(i),f=r.startsWith("cache=")?[r]:s.targetOptions&&s.targetOptions.length?s.targetOptions.map((function(e){return g(e[0])})):[g(r)],A=d(a),x=this.getId(e[this.commandIndex]),"waitFor"!==a||!i.startsWith("not_"))return[3,12];b=!0,y=0,n.label=8;case 8:return y<f.length?(v=f[y],console.log("Executing: | "+a+" | "+v+" | "+i+" |"),[4,this.executeCommand(a,v,i,A,p)]):[3,11];case 9:w=n.sent(),b=b&&"success"===w.result,n.label=10;case 10:return++y,[3,8];case 11:return b?(this.callbacks.updateCommandStatus({identifier:x,status:"success"}),[2]):(this.callbacks.updateCommandStatus({identifier:x,status:"fail",reason:"One of the locators has matched the element!"}),this.callbacks.switchOnReplayStatus("paused"),this.caseFailed=!0,this.commandIndex--,this.pause(),[3,17]);case 12:y=0,n.label=13;case 13:return y<f.length?(v=f[y],console.log("Executing: | "+a+" | "+v+" | "+i+" |"),[4,this.executeCommand(a,v,i,A,p)]):[3,16];case 14:if("success"===(w=n.sent()).result)return k=0===y?void 0:v,this.callbacks.updateCommandStatus({identifier:x,status:"success",successLocator:k}),[2];n.label=15;case 15:return++y,[3,13];case 16:this.callbacks.updateCommandStatus({identifier:x,status:"fail",reason:"Failed to find element using provided locators"}),this.callbacks.switchOnReplayStatus("paused"),this.caseFailed=!0,this.commandIndex--,this.pause(),n.label=17;case 17:return[2]}}))}))},e.prototype.executeCommand=function(e,t,s,a,i){return void 0===a&&(a=!1),void 0===i&&(i=1e4),r(this,void 0,void 0,(function(){var r,o;return n(this,(function(n){switch(n.label){case 0:r=Date.now(),n.label=1;case 1:return[4,this.extCommand.sendCommand(e,t,s,a)];case 2:return o=n.sent(),console.log(o),"success"===o.result?[2,o]:[4,c.delay(500)];case 3:n.sent(),("failed"===o.status||o.result.match(/Element[\s\S]*?not found/))&&console.log("Wait until the element is found"),n.label=4;case 4:if(Date.now()-r<i)return[3,1];n.label=5;case 5:return console.log("Implicit Wait timed out after "+i+"ms"),[2,!1]}}))}))},e.prototype.finalizePlayingProgress=function(){"pause"!==this.replayStatus&&this.extCommand.clear(),this.frames=[],this.commandIndex=0},e.prototype.findAndSaveNextStepId=function(){var e=this.lastFrame.steps[this.commandIndex+1];return this.nextStepId=this.getId(e),this.nextStepId},e.prototype.findStepByPath=function(e,t){for(var s=e,a=function(e){var t="ifElseGroup"===s.type?i(s.then,s.else):i(s.steps);s=t.find((function(t){return t.id===e}))},r=0,n=t;r<n.length;r++){a(n[r])}return s},e.prototype.rebuildFrames=function(e,t){for(var s=function(e){return e.slice(-1)[0]},r=!1,n=[e],o=e,l=function(e){var t=void 0,l=void 0;if("ifElseGroup"===o.type?(l=o.then.findIndex((function(t){return t.id===e})))>=0?(t=i(o.then),o=o.then[l]):(l=o.else.findIndex((function(t){return t.id===e})))>=0&&(t=i(o.else),o=o.else[l]):(l=o.steps.findIndex((function(t){return t.id===e})),t=i(o.steps),o=o.steps[l]),t&&(t.push({action:"ret",id:"deadbeef-dead-beef-dead-beefdead"}),s(n).steps=i(t),n.push(a({lastIndex:l},o))),!o)return r=!0,"break"},c=0,u=t;c<u.length;c++){if("break"===l(u[c]))break}var m=s(n).lastIndex;return n.pop(),{partial:r,commandIndex:m,frames:n}},e.prototype.getFirstStepId=function(){return this.frames&&this.frames[0].steps&&this.frames[0].steps[0].steps?[this.frames[0].steps[0].id,this.frames[0].steps[0].steps[0].id]:[]},Object.defineProperty(e.prototype,"lastFrame",{get:function(){return this.frames[this.frames.length-1]},enumerable:!0,configurable:!0}),e.prototype.dropLastFrame=function(){this.frames.pop()},e.prototype.getId=function(e){return i(this.frames.map((function(e){return e.id})).filter((function(e){return e})),[e.id])},e.prototype.doPreparation=function(){return r(this,void 0,void 0,(function(){var e,t;return n(this,(function(s){switch(s.label){case 0:e=Date.now(),s.label=1;case 1:return"play"!==this.replayStatus?(this.commandIndex--,[2,Promise.reject("shutdown")]):[4,this.extCommand.sendCommand("waitPreparation","","")];case 2:return t=s.sent(),console.log("waitPreparation",t),t&&t.ok?[2,!0]:(console.log("wait preparation"),[4,c.delay(500)]);case 3:s.sent(),s.label=4;case 4:if(Date.now()-e<3e4)return[3,1];s.label=5;case 5:return[2,!1]}}))}))},e.prototype.doPrePageWait=function(){return r(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:return"play"!==this.replayStatus?(this.commandIndex--,[2,Promise.reject("shutdown")]):[4,this.extCommand.sendCommand("prePageWait","","")];case 1:return(e=t.sent())&&e.new_page?[4,this.doPrePageWait()]:[3,3];case 2:return[2,t.sent()];case 3:return[2,!0]}}))}))},e.prototype.doPageWait=function(){return r(this,void 0,void 0,(function(){var e,t;return n(this,(function(s){switch(s.label){case 0:e=Date.now(),s.label=1;case 1:return"play"!==this.replayStatus?(this.commandIndex--,[2,Promise.reject("shutdown")]):[4,this.extCommand.sendCommand("pageWait","","")];case 2:return t=s.sent(),console.log("pageWait",t),t&&t.page_done?[2,!0]:(console.log("Wait for the new page to be fully loaded"),[4,c.delay(500)]);case 3:s.sent(),s.label=4;case 4:if(Date.now()-e<3e4)return[3,1];s.label=5;case 5:return console.log("Page Wait timed out after 30000ms"),[2,!1]}}))}))},e.prototype.doAjaxWait=function(){return r(this,void 0,void 0,(function(){var e,t;return n(this,(function(s){switch(s.label){case 0:e=Date.now(),s.label=1;case 1:return"play"!==this.replayStatus?(this.commandIndex--,[2,Promise.reject("shutdown")]):[4,this.extCommand.sendCommand("ajaxWait","","")];case 2:return t=s.sent(),console.log("ajaxWait",t),t&&t.ajax_done?[2,!0]:(console.log("Wait for all ajax requests to be done"),[4,c.delay(50)]);case 3:s.sent(),s.label=4;case 4:if(Date.now()-e<3e4)return[3,1];s.label=5;case 5:return console.log("Ajax Wait timed out after 30000ms"),[2,!1]}}))}))},e.prototype.doDomWait=function(){return r(this,void 0,void 0,(function(){var e,t;return n(this,(function(s){switch(s.label){case 0:e=Date.now(),s.label=1;case 1:return"play"!==this.replayStatus?(this.commandIndex--,[2,Promise.reject("shutdown")]):[4,this.extCommand.sendCommand("domWait","","")];case 2:return t=s.sent(),console.log("domWait",t),t&&(Date.now()-t.dom_time>400||!t.dom_time)?[2,!0]:(console.log("Wait for the DOM tree modification"),[4,c.delay(50)]);case 3:s.sent(),s.label=4;case 4:if(Date.now()-e<3e4)return[3,1];s.label=5;case 5:return console.log("DOM Wait timed out after 30000ms"),[2,!1]}}))}))},e.prototype.stabilizePage=function(){var e=this;return new Promise((function(t,s){var a=0,r=setInterval((function(){"play"!==e.replayStatus&&(e.commandIndex--,s("shutdown"),clearInterval(r)),a>60&&(console.log("Timed out after 30000ms"),s("Window not Found"),clearInterval(r)),e.extCommand.getPageStatus()?(t(),clearInterval(r)):(0===a&&console.log("Wait for the new page to be fully loaded"),a++)}),500)}))},e}();function d(e){return"answerOnNextPrompt"===e||"chooseCancelOnNextPrompt"===e||"assertPrompt"===e||"chooseOkOnNextConfirmation"===e||"chooseCancelOnNextConfirmation"===e||"assertConfirmation"===e||"assertAlert"===e||"assertDialog"===e||"answerDialog"===e}function g(e){if("string"!=typeof e)return e;for(var t=e.indexOf("${"),s="";-1!==t;){var a=e.substring(0,t),r=e.substring(t),n=r.indexOf("}"),i=r.substring(0,n+1),o=r.substring(n+1);s+=a+xlateArgument(i),t=(e=o).indexOf("${")}return s+e}function h(e,t){return Number(g(e))||Number(t)}t.PlaybackApi=m},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arraysMatch=function(e,t){if(e.length!==t.length)return!1;for(var s=0;s<e.length;s++)if(e[s]!==t[s])return!1;return!0}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){this.actionsMap={click:"clickAt",type:"type",keys:"sendKeys",assertText:"assertText",assertValue:"assertValue",assertTitle:"assertTitle",doubleClick:"doubleClick",mouseDown:"mouseDownAt",mouseMove:"mouseMoveAt",mouseUp:"mouseUpAt",select:"select",storeText:"storeText",storeTitle:"storeTitle",storeValue:"storeValue",storeString:"store",submit:"submit",scriptEval:"runScript",closeWindow:"close",drag:"dragAndDropToObject",echoString:"echo",editContent:"editContent",switchFrame:"selectFrame",switchWindow:"selectWindow",pauseFor:"pause",go:"open",openWindow:"openWindow",resizeWindow:"resizeWindow",maximizeWindow:"maximizeWindow",waitFor:"waitFor",answerDialog:"answerDialog",assertDialog:"assertDialog",storeEval:"storeEval",assertEval:"assertEval",mouseOver:"mouseOver",mouseOut:"mouseOut"},this.conditions={Present:"present",NotPresent:"not_present",Visible:"visible",NotVisible:"not_visible",Clickable:"clickable",NotClickable:"not_clickable"},this.selectorsMap={name:function(e){return"name="+e},linktext:function(e){return"link="+e},id:function(e){return"id="+e},css:function(e){return"css="+e},xpath:function(e){return e.startsWith("//")?e:"xpath="+e},shadow:function(e){return"shadow="+e}}}return e.prototype.map=function(e){var t=this.actionsMap[e.action],s=e.value||e.param||"",a="",r=[];("keys"===e.action&&(s="${"+s+"}"),"waitFor"===e.action)&&(s=this.conditions[e.param]+":"+1e3*e.value);if("drag"===e.action){if(r=this.populateTargets(e.source),e.target&&e.target.length>0){var n=e.target[0],i=n.name.toLowerCase();s=(0,this.selectorsMap[i])(n.value)}}else r=this.populateTargets(e.target);r.length>0&&(a=r[0][0]);return["open","openWindow","selectFrame","assertTitle","close","selectWindow","echo","store","runScript","storeEval","assertEval","answerDialog","assertDialog"].includes(t)&&(a=e.param),{command:t,value:s,target:a,targetOptions:r}},e.prototype.populateTargets=function(e){if(!e||0===e.length)return[];for(var t=[],s=0,a=e;s<a.length;s++){var r=a[s],n=r.name.toLowerCase(),i=this.selectorsMap[n];t.push([i(r.value),n])}return t},e}();t.CommandMapper=a},function(e,t){}]);